<!doctype html><html lang=en><head><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.png><meta name=msapplication-TileImage content="/safari-pinned-tab.png"><meta name=msapplication-TileColor content="#7da7d8"><meta name=theme-color content="#7da7d8"><meta charset=utf-8><meta name=description content="Eclipse Zenoh, unify data in motion, data at rest and computations."><meta name=keywords content="pub/sub,query,geo distributed storage,Rust,protocol,DDS,MQTT,Edge,IoT,MEC"><meta name=author content="The Zenoh Team"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=../../css/bootstrap-reboot.css><link rel=stylesheet href=../../css/bootstrap.css><link rel=stylesheet href=../../css/font-awesome.min.css><link rel=stylesheet href=../../css/ato.css><link rel=stylesheet href=../../css/syntax.css><link rel=alternate type=application/rss+xml href=../../blog/index.xml><title>Zenoh Bahamut takes flight! · Zenoh - pub/sub, geo distributed storage, query</title></head><body><header class="navbar-expand navbar-dark d-flex flex-column flex-md-row align-items-md-center ato-navbar"><div class="d-flex flex-row justify-content-between pl-2 pr-2"><a class=navbar-brand href=../../><img src=../../img/zenoh-dragon-bg-150x163.png class=align-middle alt></a>
<button class="btn btn-link d-md-none p-0" type=button data-toggle=collapse data-target=#ato-nav aria-controls=ato-nav aria-expanded=false aria-label="Toggle navigation"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/></svg></button></div><div class="ato-links collapse pl-4 pl-md-0" id=ato-nav><ul class="navbar-nav flex-column flex-md-row"><li class=nav-item><a class=nav-link href=../../>Home</a></li><li class=nav-item><a class=nav-link href=../../docs/getting-started/first-app/>Documentation</a></li><li class=nav-item><a class=nav-link href=../../usecases/>Use Cases</a></li><li class=nav-item><a class=nav-link href=../../community/>Community</a></li><li class=nav-item><a class=nav-link href=../../adopters/>Adopters</a></li><li class=nav-item><a class=nav-link href=../../media/>Media</a></li><li class=nav-item><a class="nav-link active" href=../../blog/2024-12-12-zenoh-firesong-1.1.0/>Blog</a></li></ul></div><ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex"><li class=nav-item><a class="nav-link p-2" href=https://github.com/eclipse-zenoh/zenoh target=_blank rel=noopener aria-label=GitHub><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false"><title>GitHub</title><path d="M256 0C114.64.0.0 114.61.0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34.0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49.0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75.0.0 21.49-6.88 70.4 26.24a242.65 242.65.0 01128.18.0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69.0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41.0 34.22-.31 61.83-.31 70.23.0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37.0 256 0z" fill="currentcolor" fill-rule="evenodd"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://twitter.com/zettascaletech target=_blank rel=noopener aria-label=Twitter><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false"><title>Twitter</title><path d="M160.83 416.32c193.2.0 298.92-160.22 298.92-298.92.0-4.51.0-9-.2-13.52A214 214 0 00512 49.38a212.93 212.93.0 01-60.44 16.6 105.7 105.7.0 0046.3-58.19 209 209 0 01-66.79 25.37 105.09 105.09.0 00-181.73 71.91 116.12 116.12.0 002.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48.0 0068 159.6a106.27 106.27.0 01-47.53-13.11v1.43a105.28 105.28.0 0084.21 103.06 105.67 105.67.0 01-47.33 1.84 105.06 105.06.0 0098.14 72.94A210.72 210.72.0 0125 370.84a202.17 202.17.0 01-25-1.43 298.85 298.85.0 00160.83 46.92" fill="currentcolor"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://discord.gg/2GJ958VuHs target=_blank rel=noopener aria-label=Discord><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" focusable="false"><title>Discord</title><path fill="currentcolor" d="M13.545 2.907a13.227 13.227.0 00-3.257-1.011.05.05.0 00-.052.025c-.141.25-.297.577-.406.833a12.19 12.19.0 00-3.658.0 8.258 8.258.0 00-.412-.833.051.051.0 00-.052-.025c-1.125.194-2.22.534-3.257 1.011a.041.041.0 00-.021.018C.356 6.024-.213 9.047.066 12.032c.001.014.01.028.021.037a13.276 13.276.0 003.995 2.02.05.05.0 00.056-.019c.308-.42.582-.863.818-1.329a.05.05.0 00-.01-.059.051.051.0 00-.018-.011 8.875 8.875.0 01-1.248-.595.05.05.0 01-.02-.066.051.051.0 01.015-.019c.084-.063.168-.129.248-.195a.05.05.0 01.051-.007c2.619 1.196 5.454 1.196 8.041.0a.052.052.0 01.053.007c.08.066.164.132.248.195a.051.051.0 01-.004.085 8.254 8.254.0 01-1.249.594.05.05.0 00-.03.03.052.052.0 00.003.041c.24.465.515.909.817 1.329a.05.05.0 00.056.019 13.235 13.235.0 004.001-2.02.049.049.0 00.021-.037c.334-3.451-.559-6.449-2.366-9.106a.034.034.0 00-.02-.019zm-8.198 7.307c-.789.0-1.438-.724-1.438-1.612.0-.889.637-1.613 1.438-1.613.807.0 1.45.73 1.438 1.613.0.888-.637 1.612-1.438 1.612zm5.316.0c-.788.0-1.438-.724-1.438-1.612.0-.889.637-1.613 1.438-1.613.807.0 1.451.73 1.438 1.613.0.888-.631 1.612-1.438 1.612z"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://www.youtube.com/channel/UCslbiyiqgOAPMjCrPWIfQ5Q target=_blank rel=noopener aria-label=Youtube><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" focusable="false"><title>Youtube</title><path fill="currentcolor" d="M8.051 1.999h.089c.822.003 4.987.033 6.11.335a2.01 2.01.0 011.415 1.42c.101.38.172.883.22 1.402l.01.104.022.26.008.104c.065.914.073 1.77.074 1.957v.075c-.001.194-.01 1.108-.082 2.06l-.008.105-.009.104c-.05.572-.124 1.14-.235 1.558a2.007 2.007.0 01-1.415 1.42c-1.16.312-5.569.334-6.18.335h-.142c-.309.0-1.587-.006-2.927-.052l-.17-.006-.087-.004-.171-.007-.171-.007c-1.11-.049-2.167-.128-2.654-.26a2.007 2.007.0 01-1.415-1.419c-.111-.417-.185-.986-.235-1.558L.09 9.82.082 9.716A31.4 31.4.0 010 7.68v-.123c.002-.215.01-.958.064-1.778l.007-.103.003-.052.008-.104.022-.26.01-.104c.048-.519.119-1.023.22-1.402a2.007 2.007.0 011.415-1.42c.487-.13 1.544-.21 2.654-.26l.17-.007.172-.006.086-.003.171-.007A99.788 99.788.0 017.858 2h.193zM6.4 5.209v4.818l4.157-2.408L6.4 5.209z"/></svg></a></li></ul><script async src="https://www.googletagmanager.com/gtag/js?id=G-PBD6MS51QL"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PBD6MS51QL")</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":""},"articleSection":"blog","name":"Zenoh Bahamut takes flight!","headline":"Zenoh Bahamut takes flight!","datePublished":"2022-09-30 00:00:00 \u002b0000 UTC","dateModified":"2022-09-30 00:00:00 \u002b0000 UTC","url":"\/blog\/2022-09-30-zenoh-bahamut\/","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"303030","wordCount":"1721","keywords":[],"description":"30 September 2022 -- Paris."}</script></header><div class="container-fluid ato-blog"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 ato-sidebar"><div class="ato-docs-toggle d-md-none p-0 d-flex ml-3 collapsed align-item-center"><h1 class=ato-title>Zenoh Bahamut takes flight!</h1><button class="btn btn-link" type=button data-toggle=collapse data-target=#ato-docs-nav aria-controls=ato-docs-nav aria-expanded=false aria-label="Toggle docs navigation"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/></svg></button></div><nav class="ato-links collapse" id=ato-docs-nav><div class="ato-toc-item active"><p class=ato-toc-link>Blog Posts</p><ul class="nav ato-sidenav"><li><a href=../../blog/2024-12-12-zenoh-firesong-1.1.0/>Zenoh 1.1.0: Firesong Keeps Rocking 🎸</a></li><li><a href=../../blog/2024-10-21-zenoh-firesong/>Zenoh 1.0.0 "Firesong" is ready to rock!</a></li><li><a href=../../blog/2024-04-30-zenoh-electrode/>Zenoh 0.11.0 "Electrode" release is out!</a></li><li><a href=../../blog/2024-04-17-datadog-zenoh-router-integration/>Streamlining Zenoh router Monitoring with Datadog Integration</a></li><li><a href=../../blog/2024-01-31-zenoh-flow-getting-started/>Zenoh-Flow 0.6.0-rc: Getting Started</a></li><li><a href=../../blog/2023-10-03-zenoh-dragonite/>Zenoh Dragonite Took Off!</a></li><li><a href=../../blog/2023-07-17-s3-backend/>Zenoh Storage Gets a Boost: Empowering Storage with S3 Integration</a></li><li><a href=../../blog/2023-06-05-charmander2/>Zenoh Charmander Grows Stronger</a></li><li><a href=../../blog/2023-04-04-letsencrypt/>Securing Zenoh with LetsEncrypt: A Comprehensive Guide</a></li><li><a href=../../blog/2023-03-21-zenoh-vs-mqtt-kafka-dds/>Comparing the Performance of Zenoh, MQTT, Kafka, and DDS</a></li><li><a href=../../blog/2023-02-10-zenoh-flow/>Data Flow programming with Zenoh-Flow</a></li><li><a href=../../blog/2023-01-17-zenoh-wireshark/>The Blue Dragon meets the Wire’s Shark</a></li><li><a href=../../blog/2023-01-10-zenoh-charmander/>Zenoh Charmander is coming to town</a></li><li><a href=../../blog/2022-11-29-zenoh-alignment/>Keeping storages aligned in Zenoh</a></li><li><a href=../../blog/2022-09-30-zenoh-bahamut/>Zenoh Bahamut takes flight!</a></li><li><a href=../../blog/2022-08-12-zenoh-serial/>There is Land Besides IP: How to Cross It with Zenoh</a></li><li><a href=../../blog/2022-06-09-zenoh-pico-above-and-beyond/>Zenoh-Pico: Above and Beyond</a></li><li><a href=../../blog/2022-04-14-rust-async-eval/>A Performance Evaluation on Rust Asynchronous Frameworks</a></li><li><a href=../../blog/2022-03-30-zenoh-mobility/>Mobility, Latency and Energy saving</a></li><li><a href=../../blog/2022-02-08-dragonbot/>DragonBotOne Egg Hatching with Zenoh and Zenoh-Pico</a></li><li><a href=../../blog/2021-11-09-ros2-zenoh-pico/>ROS 2 and microcontrollers integration via Zenoh-pico</a></li><li><a href=../../blog/2021-10-04-zenoh-pico-guide/>Zenoh goes embedded with zenoh-pico</a></li><li><a href=../../blog/2021-09-28-iac-experiences-from-the-trenches/>Indy Autonomous Challenge (IAC): Experiences from the Trenches</a></li><li><a href=../../blog/2021-07-13-zenoh-performance-async/>Zenoh performance: a stroll in Rust async wonderland</a></li><li><a href=../../blog/2021-07-05-zenoh-overhead/>Zenoh overhead: a story from our community</a></li><li><a href=../../blog/2021-06-14-zenoh-reliability/>Zenoh Reliability, Scalability and Congestion Control</a></li><li><a href=../../blog/2021-04-28-ros2-integration/>Integrating ROS2 with Eclipse zenoh</a></li><li><a href=../../blog/2021-03-23-discovery/>Minimizing Discovery Overhead in ROS2</a></li><li><a href=../../blog/2020-10-08-aithusa/>Zenoh Aithusa Hatched Out!</a></li><li><a href=../../blog/2020-06-29-zenoh-tidings/>Zenoh Tidings</a></li><li><a href=../../blog/2020-01-01-zenohtude/>A Year Full of Zenoh</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 ato-toc"><div class=section-nav><nav id=TableOfContents><ul><li><a href=#rust>Rust</a></li><li><a href=#python>Python</a></li><li><a href=#c>C</a></li></ul></nav></div></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 ato-content ato-docs"><h1 class=ato-title>Zenoh Bahamut takes flight!</h1><p class=ato-date>30 September 2022 -- Paris.</p><p>The little Zenoh dragon has vigorously grown up in the last year and now craves to take higher flight towards the highest peaks in marvellous lands.</p><p><img src=../../img/zenoh-dragon-small.png alt="Zenoh logo"></p><p>The new 0.6.0 release of Zenoh is code-named Bahamut: the king of the good dragons. This reflects the major efforts the development team and the community have put in Zenoh to make it grow healthy, strong, wise, and resolute. Bahamut comes with a supercharged list of new features and improvements, including:</p><ul><li>an improved and streamlined API for Rust, C, and Python</li><li>a formalized syntax and semantic for key expressions</li><li>a brand-new configuration file supporting json5 and yaml encodings</li><li>better performance delivering more than 51 Gb/s and 15us latency</li><li>support for more network transports: websocket, bluetooth, and serial</li><li>support for replicated storage alignment</li><li>support for more platforms and multicast transport in zenoh-pico</li><li>many bug fixes</li></ul><p>The full change list for Bahamut can be found <a href=https://github.com/eclipse-zenoh/zenoh/releases/tag/0.6.0-beta.1>here</a>. But let’s find out together what the main news is and what’s next.</p><hr><h1 id=an-improved-api>An improved API</h1><p>A brand new API has just landed. And this is without a shadow of a doubt the biggest change brought by Zenoh Bahamut. Some of you may say “oh no, this is a breaking change” and some others may say “oh yes, tons of cool new features”! But worry not! Even if this is a breaking change, moving to the new API is quite trivial (see the <a href=https://zenoh.io/docs/migration/migrationguide-v0.5.x-v0.6.x/>migration guide</a>)!</p><p>So, let’s have a look at why we did it.</p><p><a href=https://github.com/eclipse-zenoh/zenoh>Zenoh</a> is written in Rust and targets a large spectrum of hardware ranging from enterprise grade to embedded. Zenoh is also paired up with <a href=https://github.com/eclipse-zenoh/zenoh-pico>Zenoh-Pico</a>, which is written in C, to expand our reach to the tiniest microcontrollers. Moreover, on top of the Rust implementation, <a href=https://github.com/eclipse-zenoh/zenoh-c>C</a> and <a href=https://github.com/eclipse-zenoh/zenoh-python>Python</a> bindings are provided, and many more are to come. Therefore, a new API was necessary to bring the required expressiveness, flexibility, and stability across different programming languages while having a similar look and feel.</p><p>The second reason lies in the need of having an API surface as minimal as possible so as to not overload tiny microcontrollers with a bulky and complex interface. Moreover, a minimal API surface also helps in creating and maintaining a more language-specific implementation for the bindings.</p><p>Last but not least, future extensibility was the third objective for the new API. Depending on the programming language, future extensibility is provided by three paradigms: builder pattern (e.g. in Rust), kwargs with default values (e.g. in Python), and option struct (e.g. in C). This allows Zenoh API to accommodate the addition of any new capability in the future whilst being backward compatible.</p><p>If you are curious about the philosophy of the new API, you can find the full discussion <a href=https://github.com/eclipse-zenoh/roadmap/discussions/23>here</a>.</p><h2 id=rust>Rust</h2><p><em>Subscriber</em> &ndash; Full working example available <a href=https://github.com/eclipse-zenoh/zenoh/blob/main/examples/examples/z_sub.rs>here</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Rust data-lang=Rust><span style=display:flex><span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span>session<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>zenoh::open(config).res().<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span>subscriber<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>session.declare_subscriber(<span style=color:#c30>&#34;test&#34;</span>).reliable().res().<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#069;font-weight:700>while</span><span style=color:#bbb> </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span><span style=color:#366>Ok</span>(sample)<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>subscriber.recv_async().<span style=color:#069;font-weight:700>await</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>println!(<span style=color:#c30>&#34;&#39;{}&#39;: &#39;{}&#39;&#34;</span>,<span style=color:#bbb> </span>sample.key_expr.as_str(),<span style=color:#bbb> </span>sample.value);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p><em>Publisher</em> &ndash; Full working example available <a href=https://github.com/eclipse-zenoh/zenoh/blob/main/examples/examples/z_pub.rs>here</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Rust data-lang=Rust><span style=display:flex><span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span>session<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>zenoh::open(config).res().<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span>publisher<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>session.declare_publisher(<span style=color:#c30>&#34;test&#34;</span>).res().<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#069;font-weight:700>loop</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>async_std::task::sleep(Duration::from_secs(<span style=color:#f60>1</span>)).<span style=color:#069;font-weight:700>await</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>publisher.put(<span style=color:#c30>&#34;data&#34;</span>).res().<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h2 id=python>Python</h2><p><em>Subscriber</em> &ndash; Full working example available <a href=https://github.com/eclipse-zenoh/zenoh-python/blob/main/examples/z_sub.py>here</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Python data-lang=Python><span style=display:flex><span><span style=color:#069;font-weight:700>def</span> <span style=color:#c0f>listener</span>(sample: Sample):
</span></span><span style=display:flex><span>    <span style=color:#366>print</span>(<span style=color:#c30>f</span><span style=color:#c30>&#34;&#39;</span><span style=color:#a00>{</span>sample<span style=color:#555>.</span>key_expr<span style=color:#a00>}</span><span style=color:#c30>&#39;: &#39;</span><span style=color:#a00>{</span>sample<span style=color:#555>.</span>payload<span style=color:#555>.</span>decode(<span style=color:#c30>&#39;utf-8&#39;</span>)<span style=color:#a00>}</span><span style=color:#c30>&#39;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>session <span style=color:#555>=</span> zenoh<span style=color:#555>.</span>open(conf)
</span></span><span style=display:flex><span>sub <span style=color:#555>=</span> session<span style=color:#555>.</span>declare_subscriber(<span style=color:#c30>&#34;test&#34;</span>, listener, reliability<span style=color:#555>=</span>Reliability<span style=color:#555>.</span>Reliable)
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>while</span> <span style=color:#069;font-weight:700>True</span>:
</span></span><span style=display:flex><span>    time<span style=color:#555>.</span>sleep(<span style=color:#f60>1.0</span>)
</span></span></code></pre></div><p><em>Publisher</em> &ndash; Full working example available <a href=https://github.com/eclipse-zenoh/zenoh-python/blob/main/examples/z_pub.py>here</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Python data-lang=Python><span style=display:flex><span>session <span style=color:#555>=</span> zenoh<span style=color:#555>.</span>open(conf)
</span></span><span style=display:flex><span>pub <span style=color:#555>=</span> session<span style=color:#555>.</span>declare_publisher(<span style=color:#c30>&#34;test&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>while</span> <span style=color:#069;font-weight:700>True</span>:
</span></span><span style=display:flex><span>    time<span style=color:#555>.</span>sleep(<span style=color:#f60>1.0</span>)
</span></span><span style=display:flex><span>    pub<span style=color:#555>.</span>put(<span style=color:#c30>&#34;data&#34;</span>)
</span></span></code></pre></div><h2 id=c>C</h2><p><em>Subscriber</em> &ndash; Full working example available <a href=https://github.com/eclipse-zenoh/zenoh-c/blob/main/examples/z_sub.c>here</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#078;font-weight:700>void</span> <span style=color:#c0f>data_handler</span>(<span style=color:#069;font-weight:700>const</span> z_sample_t <span style=color:#555>*</span>sample, <span style=color:#069;font-weight:700>const</span> <span style=color:#078;font-weight:700>void</span> <span style=color:#555>*</span>arg) {
</span></span><span style=display:flex><span>    <span style=color:#078;font-weight:700>char</span> <span style=color:#555>*</span>keystr <span style=color:#555>=</span> z_keyexpr_to_string(sample<span style=color:#555>-&gt;</span>keyexpr);
</span></span><span style=display:flex><span>    printf(<span style=color:#c30>&#34;&#39;%s&#39;: &#39;%.*s&#39;</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>, keystr, (<span style=color:#078;font-weight:700>int</span>)sample<span style=color:#555>-&gt;</span>payload.len, sample<span style=color:#555>-&gt;</span>payload.start);
</span></span><span style=display:flex><span>    free(keystr);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#078;font-weight:700>int</span> <span style=color:#c0f>main</span>(<span style=color:#078;font-weight:700>int</span> argc, <span style=color:#078;font-weight:700>char</span> <span style=color:#555>**</span>argv) {
</span></span><span style=display:flex><span>    z_owned_session_t s <span style=color:#555>=</span> z_open(z_move(z_config_default()));
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>if</span> (<span style=color:#555>!</span>z_check(s)) {
</span></span><span style=display:flex><span>        exit(<span style=color:#555>-</span><span style=color:#f60>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    z_subscriber_options_t opts <span style=color:#555>=</span> z_subscriber_options_default();
</span></span><span style=display:flex><span>    opts.reliability <span style=color:#555>=</span> Z_RELIABILITY_RELIABLE;
</span></span><span style=display:flex><span>    z_owned_closure_sample_t callback <span style=color:#555>=</span> z_closure(data_handler);
</span></span><span style=display:flex><span>    z_owned_subscriber_t sub <span style=color:#555>=</span> z_declare_subscriber(z_loan(s), z_keyexpr(expr), z_move(callback), <span style=color:#555>&amp;</span>opts);
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>if</span> (<span style=color:#555>!</span>z_check(sub)) {
</span></span><span style=display:flex><span>        exit(<span style=color:#555>-</span><span style=color:#f60>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>while</span> (<span style=color:#f60>1</span>) { sleep(<span style=color:#f60>1</span>); }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><em>Publisher</em> &ndash; Full working example available <a href=https://github.com/eclipse-zenoh/zenoh-c/blob/main/examples/z_pub.c>here</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span><span style=color:#078;font-weight:700>int</span> <span style=color:#c0f>main</span>(<span style=color:#078;font-weight:700>int</span> argc, <span style=color:#078;font-weight:700>char</span> <span style=color:#555>**</span>argv) {
</span></span><span style=display:flex><span>    z_owned_config_t config <span style=color:#555>=</span> z_config_default();
</span></span><span style=display:flex><span>    z_owned_session_t s <span style=color:#555>=</span> z_open(z_move(config));
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>if</span> (<span style=color:#555>!</span>z_check(s)) {
</span></span><span style=display:flex><span>        exit(<span style=color:#555>-</span><span style=color:#f60>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    z_owned_publisher_t pub <span style=color:#555>=</span> z_declare_publisher(z_loan(s), z_keyexpr(keyexpr), <span style=color:#366>NULL</span>);
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>if</span> (<span style=color:#555>!</span>z_check(pub)) {
</span></span><span style=display:flex><span>        exit(<span style=color:#555>-</span><span style=color:#f60>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#078;font-weight:700>char</span> buf[] <span style=color:#555>=</span> <span style=color:#a00;background-color:#faa>“</span>data<span style=color:#a00;background-color:#faa>”</span>;
</span></span><span style=display:flex><span>    z_publisher_put_options_t options <span style=color:#555>=</span> z_publisher_put_options_default();
</span></span><span style=display:flex><span>    options.encoding <span style=color:#555>=</span> z_encoding(Z_ENCODING_PREFIX_TEXT_PLAIN, <span style=color:#366>NULL</span>);
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>for</span> (<span style=color:#078;font-weight:700>int</span> idx <span style=color:#555>=</span> <span style=color:#f60>0</span>; <span style=color:#f60>1</span>; <span style=color:#555>++</span>idx) {
</span></span><span style=display:flex><span>        sleep(<span style=color:#f60>1</span>);
</span></span><span style=display:flex><span>        z_publisher_put(z_loan(pub), (<span style=color:#069;font-weight:700>const</span> <span style=color:#078;font-weight:700>uint8_t</span> <span style=color:#555>*</span>)buf, strlen(buf), <span style=color:#555>&amp;</span>options);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Additionally, in C we have defined an ownership model to help developers to safely handle data when using Zenoh. You can refer to this <a href=https://github.com/eclipse-zenoh/roadmap/blob/main/rfcs/ALL/Ownership%20in%20C.md>RFC</a> for a more detailed explanation of the ownership model.</p><hr><h1 id=formalized-key-expressions>Formalized key expressions</h1><p>Zenoh is governed by content-centric concepts, thus it uses key expressions to address data.
A thoughtful definition and formalization of what a key expression is and looks like has been done in Zenoh Bahamut.
This effort has been undertaken for three main reasons:</p><ol><li>To avoid ambiguity in key expression definition and matching, which before could lead to undefined behaviour.</li><li>To improve the key expression matcher for better performance.</li><li>To allow future extensibility to be introduced for more complex matching and behaviours.</li></ol><p>Briefly, we can summarize the main changes here below:</p><ul><li>A key expression is as <code>/</code>-separated list of chunks, where each chunk is a non-empty (UTF-8) string</li><li>Leading and trailing <code>/</code> are not valid. This was necessary to avoid ambiguity.</li><li><code>$</code> indicates a DSL for key expression matching. The first DSL defined is <code>$*</code>, which allows sub-chunk matching.</li><li>Key expressions can be reduced to a non-ambiguous canonical form that is uniquely defined.</li></ul><p>The single wild <code>*</code> expresses <em>exactly one chunk of any value</em>, and is equivalent to the <code>[^/]+</code> regular expression.
For example, <code>a/*/b</code>:</p><ul><li>Includes <code>a/c/b</code>, <code>a/hi/b</code></li><li>Intersects <code>*/a/b</code>, <code>*/*/*</code></li><li>Does not intersect <code>a/*/c</code>, <code>b/*/a</code></li></ul><p>The double wild <code>**</code> expresses <em>any amount (including 0) of chunks of any values</em>.
For example, <code>a/**/b</code>:</p><ul><li>Includes <code>a/b</code>, <code>a/**/b/b</code>, <code>a/*/b</code>, <code>a/*/*/b</code>, <code>a/*/**/b</code>, <code>a/**/c/**/b</code></li><li>Intersects <code>**/b</code>, <code>a/**</code></li><li>Does not intersect <code>a/**/b/c</code></li></ul><p>For a more in-depth reading on key expressions, please refer to this <a href=https://github.com/eclipse-zenoh/roadmap/blob/main/rfcs/ALL/Key%20Expressions.md>RFC</a>.</p><hr><h1 id=a-new-configuration-file-format>A new configuration file format</h1><p>A new json5/yaml-based configuration file has been added. This allows configuring various aspects of Zenoh via a simple yet comprehensive file that can be extended as needed in the future. A snippet of the configuration file can be found below while the full configuration file can be found <a href=https://github.com/eclipse-zenoh/zenoh/blob/main/DEFAULT_CONFIG.json5>here</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Json data-lang=Json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#309;font-weight:700>&#34;mode&#34;</span>: <span style=color:#c30>&#34;peer&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#09f;font-style:italic>// Connect to a specific router at startup time
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>  <span style=color:#309;font-weight:700>&#34;connect&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#309;font-weight:700>&#34;endpoints&#34;</span>: [
</span></span><span style=display:flex><span>      <span style=color:#c30>&#34;tcp/myzenohrouter.com:7447&#34;</span>
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#09f;font-style:italic>// Accept any connections from other peers
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>  <span style=color:#309;font-weight:700>&#34;listen&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#309;font-weight:700>&#34;endpoints&#34;</span>: [
</span></span><span style=display:flex><span>      <span style=color:#c30>&#34;tcp/192.168.1.10:7447&#34;</span>
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#09f;font-style:italic>// Enable multicast scouting to discover neighboring peers
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>  <span style=color:#309;font-weight:700>&#34;scouting&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#309;font-weight:700>&#34;multicast&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#309;font-weight:700>&#34;enabled&#34;</span>: <span style=color:#069;font-weight:700>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#309;font-weight:700>&#34;listen&#34;</span>: <span style=color:#069;font-weight:700>true</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Please note that the configuration via a json5/yaml file is available only for the <a href=https://github.com/eclipse-zenoh/zenoh>Zenoh</a> implementation written in Rust and any bindings based on it. <a href=https://github.com/eclipse-zenoh/zenoh-pico>Zenoh-Pico</a> does not support such a way of configuring since it will be simply too heavy for microcontrollers.</p><hr><h1 id=improved-routing>Improved routing</h1><p>The <strong>peer</strong> mode now supports 2 different routing strategies for local subsystems:</p><ul><li><strong>linkstate</strong>: This is the only strategy that was supported in the previous release. It supports any topology like mesh networks for example.</li><li><strong>peer_to_peer</strong>: With this strategy, all peers in the subsystem need to directly connect to each other. It offers a much greater scalability compared to the linkstate mode (approximately 10 times more nodes per subsystem in a similar environment) and overall better performances (smaller network overhead, smaller memory footprint, lower CPU consumption and faster alignment). This is the new default.</li></ul><hr><h1 id=improved-performance>Improved performance</h1><p>In this <a href=https://zenoh.io/blog/2021-07-13-zenoh-performance-async/>blog post</a> we reported that Zenoh Aithusa delivered more than <code>3.5 million msg/s</code> with <code>8 bytes</code> payload, more than <code>45 Gb/s</code> with <code>1 Megabyte</code> payload, and a latency as little as <code>35 µs</code> in backlogged scenarios. On the exactly same machine and 100Gb Ethernet connection, Zenoh Bahamut now brings significant performance gains by delivering:</p><ul><li>more than <code>4.2 million msg/s</code> with <code>8 bytes</code> payload,</li><li>more than <code>51 Gb/s</code> with <code>1 Megabyte</code> payload,</li><li>a latency as little as <code>15 µs</code> in backlogged scenarios.</li></ul><p>The figure below shows (in log scale) the number of messages per second for different payloads: from <code>8 bytes</code> to <code>1 GiB</code>.</p><p><img src=../../img/20220930-blog-zenoh-bahamut/throughput-msg.png alt="Throughput - Msg/s"></p><p>The figure below shows (in log scale) the results in terms of throughput (bit/s) delivered at API level. We also report the throughput obtained with iperf on the same 100GbE connection as reference baseline: <code>60 Gb/s</code>.</p><p><img src=../../img/20220930-blog-zenoh-bahamut/throughput-gbs.png alt="Throughput - Gb/s"></p><p>The figure below shows (in log scale) the one-hop latency for different message rates. The inf case represents the scenario where messages are sent back-to-back as fast as possible. In such a backlogged scenario, we can see that zenoh latency is as little as 15 µsec, less than half of before. The payload size is 64 bytes, the same as standard ICMP. A more in-depth explanation on why latency decreases when the message rate increases is available <a href=https://zenoh.io/blog/2021-07-13-zenoh-performance-async/#latency>here</a>.</p><p><img src=../../img/20220930-blog-zenoh-bahamut/latency.png alt=Latency></p><hr><h1 id=replicated-storages>Replicated Storages</h1><p>Zenoh Bahamut brings in a new experimental feature to support replicated storage alignment. Zenoh now ensures eventual consistency for storages that subscribe to the same key expression, even in the presence of network partitions and system faults. The storage alignment protocol that takes care of this convergence property is called anti-entropy protocol; as the name suggests, it keeps the entropy in the system low. Further details on the protocol and the usage are coming soon!</p><hr><h1 id=zenoh-pico>Zenoh-Pico</h1><p>Zenoh also evolved its lightweight implementation targeting microcontrollers. In addition to the above features, Zenoh-Pico introduces other improvements, not only in terms of supporting platforms but also in terms of better suitability for such constrained devices.</p><p><img src=../../img/20220930-blog-zenoh-bahamut/boards.png alt=Boards></p><p>The <a href=https://github.com/eclipse-zenoh/zenoh-pico>list of supported platforms</a> has been extended with:</p><ul><li>More RTOSs, including well-known platforms like <a href=https://os.mbed.com/>MbedOS</a> and <a href=https://docs.espressif.com/projects/esp-idf/en/latest/esp32/>ESP-IDF</a>.</li><li>BSD in the family of Unix systems.</li><li><a href=https://emanual.robotis.com/docs/en/parts/controller/opencr10/>OpenCR</a> boards, allowing a native port of a Turtlebot3 to be <a href=https://zenoh.io/blog/2022-02-08-dragonbot/>Zenoh-powered only</a>.</li><li>Constrained and/or low power networks, including <a href=https://zenoh.io/blog/2022-08-12-zenoh-serial/>Serial</a>, <a href=https://www.bluetooth.com/learn-about-bluetooth/tech-overview/>Bluetooth</a> and <a href=https://openthread.io/>Thread</a> protocols.</li></ul><p>Moreover, we have improved the design of Zenoh-Pico to better fit the requirements of the embedded systems and microcontrollers, including:</p><ul><li>Allow configuration of features (including their enable/disable) at compilation time in order to reduce its footprint, including support for single or multiple thread mode.</li><li>Improve memory alignment per supported platform.</li><li>Improve randomness of number generators (RNG), using hardware-based RGN when available.</li></ul><p>Finally, as experimental support, Zenoh-Pico now supports <strong>peer</strong> mode for <strong>multicast</strong> transports.</p><hr><h1 id=whats-next>What’s next?</h1><p>Are you ready to keep rocking with Zenoh?</p><p><img src=../../img/20220930-blog-zenoh-bahamut/zenoh-on-fire.gif alt=Guitar></p><p>These are the cool features you can expect for the months to come:</p><ul><li>A <a href=https://github.com/eclipse-zenoh/roadmap/issues/29>MQTT plugin</a></li><li>A <a href=https://github.com/eclipse-zenoh/roadmap/issues/54>Amazon S3</a> storage backend</li><li>More <a href=https://github.com/eclipse-zenoh/roadmap/issues/35>DDS features</a> in the Zenoh plugin for DDS</li><li>New features such as Key Formatters</li></ul><p>And many other cool things&mldr;</p><p>And don’t forget to stay in touch with the Zenoh team on <a href=https://discord.gg/vSDSpqnbkm>Discord</a> and to propose new features on the <a href=https://github.com/eclipse-zenoh/roadmap/discussions>roadmap</a>.</p><p><a href=https://github.com/orgs/eclipse-zenoh/people><strong>&ndash;The Zenoh Team</strong></a></p><div class=ato-next><b>Next up</b>: <a href=../../blog/2022-08-12-zenoh-serial/>There is Land Besides IP: How to Cross It with Zenoh</a></div></main></div></div><footer class="ato-footer text-muted"><div class="container-fluid p-6 p-md-5"><div class=row><div class=col-md-2><h5>Eclipse Incubation</h5><p><img src=../../img/eclipse-incubation.png style=width:100px></p><p>Eclipse zenoh &trade; is an incubating project under the Eclipse Foundation.</p></div><div class=col-md-2><h5>More Information</h5><p><a href=https://www.eclipse.org/legal target=_blank>Legal</a></p><p><a href=https://www.eclipse.org/legal/privacy.php target=_blank>Privacy policy</a></p><p><a href=https://www.eclipse.org/legal/termsofuse.php target=_blank>Terms of use</a></p><p><a href=https://www.eclipse.org/legal/copyright.php target=_blank>Copyright</a></p><p><a href=https://www.eclipse.org/security/ target=_blank>Report a security issue</a></p><p><a href=https://www.eclipse.org/legal/epl-2.0/ target=_blank>Eclipse Public License 2.0</a></p><p><a href=https://www.apache.org/licenses/LICENSE-2.0 target=_blank>Apache License 2.0</a></p><p><a href=https://www.eclipse.org/ target=_blank>Eclipse Foundation</a></p></div><div class=col-md-2><h5>Sponsored by:</h5><p><a href=https://www.eclipse.org target=_blank><img src=../../img/eclipse-foundation.svg style=width:120px></a></p><p><a href=https://zettascale.tech target=_blank><img src=../../img/zettascale-dark.svg style=width:120px></a></p></div><div class=col-md-2><h5>Follow us</h5><p><a href=https://github.com/eclipse-zenoh/zenoh><i class="fa fa-github" aria-hidden=true></i>
GitHub</a></p><p><a href=https://discord.gg/vSDSpqnbkm><i class="fa fa fa-comments-o" aria-hidden=true></i>
Discord</a></p><p><a href=https://www.youtube.com/channel/UCslbiyiqgOAPMjCrPWIfQ5Q><i class="fa fa-youtube-play" aria-hidden=true></i> Youtube</a></p><p><a href=../../docs/overview/what-is-zenoh><i class="fa fa-info-circle" aria-hidden=true></i> About</a></p></div><div class=col-md-2><p><img src=../../img/zenoh-dragon-150x163.png style=width:45px></p><p>Eclipse zenoh &trade; is free, open source and always will be.</p><p>Copyright &copy 2022 Eclipse Foundation</p><p>Built with <a href=https://gohugo.io/ target=_blank>HUGO</a></p></div></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js integrity=sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7 crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js integrity=sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8 crossorigin=anonymous></script>
<script src=../../js/bootstrap.min.js></script>
<script src=../../js/highlight.min.js></script>
<script>$(function(){$("pre code").each(function(e,t){if(t.className.indexOf("language-rust")>=0){for(var s="",n=t.textContent.split(`
`),e=0;e<n.length;e++){if(n[e].indexOf("# ")==0||n[e]=="#")continue;s+=n[e].trimRight()+`
`}t.textContent=s.replace(/\n\n\n/g,`

`).trimRight()}hljs.highlightBlock(t)})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PBD6MS51QL"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PBD6MS51QL",{anonymize_ip:!1})}</script></body></html>