<!doctype html><html lang=en><head><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.png><meta name=msapplication-TileImage content="/safari-pinned-tab.png"><meta name=msapplication-TileColor content="#7da7d8"><meta name=theme-color content="#7da7d8"><meta charset=utf-8><meta name=description content="Eclipse Zenoh, unify data in motion, data at rest and computations."><meta name=keywords content="pub/sub,query,geo distributed storage,Rust,protocol,DDS,MQTT,Edge,IoT,MEC"><meta name=author content="The Zenoh Team"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=../../css/bootstrap-reboot.css><link rel=stylesheet href=../../css/bootstrap.css><link rel=stylesheet href=../../css/font-awesome.min.css><link rel=stylesheet href=../../css/ato.css><link rel=stylesheet href=../../css/syntax.css><link rel=alternate type=application/rss+xml href=../../blog/index.xml><title>Zenoh GozuryÅ« is Here! Â· Zenoh - pub/sub, geo distributed storage, query</title></head><body><header class="navbar-expand navbar-dark d-flex flex-column flex-md-row align-items-md-center ato-navbar"><div class="d-flex flex-row justify-content-between pl-2 pr-2"><a class=navbar-brand href=../../><img src=../../img/zenoh-dragon-bg-150x163.png class=align-middle alt></a>
<button class="btn btn-link d-md-none p-0" type=button data-toggle=collapse data-target=#ato-nav aria-controls=ato-nav aria-expanded=false aria-label="Toggle navigation"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/></svg></button></div><div class="ato-links collapse pl-4 pl-md-0" id=ato-nav><ul class="navbar-nav flex-column flex-md-row"><li class=nav-item><a class=nav-link href=../../>Home</a></li><li class=nav-item><a class=nav-link href=../../docs/getting-started/first-app/>Documentation</a></li><li class=nav-item><a class=nav-link href=../../usecases/>Use Cases</a></li><li class=nav-item><a class=nav-link href=../../community/>Community</a></li><li class=nav-item><a class=nav-link href=../../adopters/>Adopters</a></li><li class=nav-item><a class=nav-link href=../../media/>Media</a></li><li class=nav-item><a class="nav-link active" href=../../blog/2025-07-28-zenoh-hong/>Blog</a></li></ul></div><ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex"><li class=nav-item><a class="nav-link p-2" href=https://github.com/eclipse-zenoh/zenoh target=_blank rel=noopener aria-label=GitHub><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false"><title>GitHub</title><path d="M256 0C114.64.0.0 114.61.0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34.0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49.0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75.0.0 21.49-6.88 70.4 26.24a242.65 242.65.0 01128.18.0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69.0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41.0 34.22-.31 61.83-.31 70.23.0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37.0 256 0z" fill="currentcolor" fill-rule="evenodd"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://twitter.com/zettascaletech target=_blank rel=noopener aria-label=Twitter><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false"><title>Twitter</title><path d="M160.83 416.32c193.2.0 298.92-160.22 298.92-298.92.0-4.51.0-9-.2-13.52A214 214 0 00512 49.38a212.93 212.93.0 01-60.44 16.6 105.7 105.7.0 0046.3-58.19 209 209 0 01-66.79 25.37 105.09 105.09.0 00-181.73 71.91 116.12 116.12.0 002.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48.0 0068 159.6a106.27 106.27.0 01-47.53-13.11v1.43a105.28 105.28.0 0084.21 103.06 105.67 105.67.0 01-47.33 1.84 105.06 105.06.0 0098.14 72.94A210.72 210.72.0 0125 370.84a202.17 202.17.0 01-25-1.43 298.85 298.85.0 00160.83 46.92" fill="currentcolor"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://discord.gg/2GJ958VuHs target=_blank rel=noopener aria-label=Discord><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" focusable="false"><title>Discord</title><path fill="currentcolor" d="M13.545 2.907a13.227 13.227.0 00-3.257-1.011.05.05.0 00-.052.025c-.141.25-.297.577-.406.833a12.19 12.19.0 00-3.658.0 8.258 8.258.0 00-.412-.833.051.051.0 00-.052-.025c-1.125.194-2.22.534-3.257 1.011a.041.041.0 00-.021.018C.356 6.024-.213 9.047.066 12.032c.001.014.01.028.021.037a13.276 13.276.0 003.995 2.02.05.05.0 00.056-.019c.308-.42.582-.863.818-1.329a.05.05.0 00-.01-.059.051.051.0 00-.018-.011 8.875 8.875.0 01-1.248-.595.05.05.0 01-.02-.066.051.051.0 01.015-.019c.084-.063.168-.129.248-.195a.05.05.0 01.051-.007c2.619 1.196 5.454 1.196 8.041.0a.052.052.0 01.053.007c.08.066.164.132.248.195a.051.051.0 01-.004.085 8.254 8.254.0 01-1.249.594.05.05.0 00-.03.03.052.052.0 00.003.041c.24.465.515.909.817 1.329a.05.05.0 00.056.019 13.235 13.235.0 004.001-2.02.049.049.0 00.021-.037c.334-3.451-.559-6.449-2.366-9.106a.034.034.0 00-.02-.019zm-8.198 7.307c-.789.0-1.438-.724-1.438-1.612.0-.889.637-1.613 1.438-1.613.807.0 1.45.73 1.438 1.613.0.888-.637 1.612-1.438 1.612zm5.316.0c-.788.0-1.438-.724-1.438-1.612.0-.889.637-1.613 1.438-1.613.807.0 1.451.73 1.438 1.613.0.888-.631 1.612-1.438 1.612z"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://www.youtube.com/channel/UCslbiyiqgOAPMjCrPWIfQ5Q target=_blank rel=noopener aria-label=Youtube><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" focusable="false"><title>Youtube</title><path fill="currentcolor" d="M8.051 1.999h.089c.822.003 4.987.033 6.11.335a2.01 2.01.0 011.415 1.42c.101.38.172.883.22 1.402l.01.104.022.26.008.104c.065.914.073 1.77.074 1.957v.075c-.001.194-.01 1.108-.082 2.06l-.008.105-.009.104c-.05.572-.124 1.14-.235 1.558a2.007 2.007.0 01-1.415 1.42c-1.16.312-5.569.334-6.18.335h-.142c-.309.0-1.587-.006-2.927-.052l-.17-.006-.087-.004-.171-.007-.171-.007c-1.11-.049-2.167-.128-2.654-.26a2.007 2.007.0 01-1.415-1.419c-.111-.417-.185-.986-.235-1.558L.09 9.82.082 9.716A31.4 31.4.0 010 7.68v-.123c.002-.215.01-.958.064-1.778l.007-.103.003-.052.008-.104.022-.26.01-.104c.048-.519.119-1.023.22-1.402a2.007 2.007.0 011.415-1.42c.487-.13 1.544-.21 2.654-.26l.17-.007.172-.006.086-.003.171-.007A99.788 99.788.0 017.858 2h.193zM6.4 5.209v4.818l4.157-2.408L6.4 5.209z"/></svg></a></li></ul><script async src="https://www.googletagmanager.com/gtag/js?id=G-PBD6MS51QL"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PBD6MS51QL")</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":""},"articleSection":"blog","name":"Zenoh GozuryÅ« is Here!","headline":"Zenoh GozuryÅ« is Here!","datePublished":"2025-04-14 00:00:00 \u002b0000 UTC","dateModified":"2025-04-14 00:00:00 \u002b0000 UTC","url":"\/blog\/2025-04-14-zenoh-gozuryu\/","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"141414","wordCount":"3751","keywords":[],"description":"14th April, 2025 -- Paris."}</script></header><div class="container-fluid ato-blog"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 ato-sidebar"><div class="ato-docs-toggle d-md-none p-0 d-flex ml-3 collapsed align-item-center"><h1 class=ato-title>Zenoh GozuryÅ« is Here!</h1><button class="btn btn-link" type=button data-toggle=collapse data-target=#ato-docs-nav aria-controls=ato-docs-nav aria-expanded=false aria-label="Toggle docs navigation"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/></svg></button></div><nav class="ato-links collapse" id=ato-docs-nav><div class="ato-toc-item active"><p class=ato-toc-link>Blog Posts</p><ul class="nav ato-sidenav"><li><a href=../../blog/2025-07-28-zenoh-hong/>Zenoh 1.5.0: Hong, the Red Dragon's Power</a></li><li><a href=../../blog/2025-07-11-zenoh-pico-peer-to-peer-unicast/>Zenoh-Pico Peer to Peer Improvements</a></li><li><a href=../../blog/2025-04-09-zenoh-pico-performance/>Zenoh-Pico performance improvements</a></li><li><a href=../../blog/2025-04-14-zenoh-gozuryu/>Zenoh GozuryÅ« is Here!</a></li><li><a href=../../blog/2025-01-08-introducing-raspberry-pi-pico-support-in-zenoh-pico/>Introducing Raspberry Pi Pico Support in Zenoh-Pico</a></li><li><a href=../../blog/2024-12-12-zenoh-firesong-1.1.0/>Zenoh 1.1.0: Firesong Keeps Rocking ðŸŽ¸</a></li><li><a href=../../blog/2024-10-21-zenoh-firesong/>Zenoh 1.0.0 "Firesong" is ready to rock!</a></li><li><a href=../../blog/2024-04-30-zenoh-electrode/>Zenoh 0.11.0 "Electrode" release is out!</a></li><li><a href=../../blog/2024-04-17-datadog-zenoh-router-integration/>Streamlining Zenoh router Monitoring with Datadog Integration</a></li><li><a href=../../blog/2024-01-31-zenoh-flow-getting-started/>Zenoh-Flow 0.6.0-rc: Getting Started</a></li><li><a href=../../blog/2023-10-03-zenoh-dragonite/>Zenoh Dragonite Took Off!</a></li><li><a href=../../blog/2023-07-17-s3-backend/>Zenoh Storage Gets a Boost: Empowering Storage with S3 Integration</a></li><li><a href=../../blog/2023-06-05-charmander2/>Zenoh Charmander Grows Stronger</a></li><li><a href=../../blog/2023-04-04-letsencrypt/>Securing Zenoh with LetsEncrypt: A Comprehensive Guide</a></li><li><a href=../../blog/2023-03-21-zenoh-vs-mqtt-kafka-dds/>Comparing the Performance of Zenoh, MQTT, Kafka, and DDS</a></li><li><a href=../../blog/2023-02-10-zenoh-flow/>Data Flow programming with Zenoh-Flow</a></li><li><a href=../../blog/2023-01-17-zenoh-wireshark/>The Blue Dragon meets the Wireâ€™s Shark</a></li><li><a href=../../blog/2023-01-10-zenoh-charmander/>Zenoh Charmander is coming to town</a></li><li><a href=../../blog/2022-11-29-zenoh-alignment/>Keeping storages aligned in Zenoh</a></li><li><a href=../../blog/2022-09-30-zenoh-bahamut/>Zenoh Bahamut takes flight!</a></li><li><a href=../../blog/2022-08-12-zenoh-serial/>There is Land Besides IP: How to Cross It with Zenoh</a></li><li><a href=../../blog/2022-06-09-zenoh-pico-above-and-beyond/>Zenoh-Pico: Above and Beyond</a></li><li><a href=../../blog/2022-04-14-rust-async-eval/>A Performance Evaluation on Rust Asynchronous Frameworks</a></li><li><a href=../../blog/2022-03-30-zenoh-mobility/>Mobility, Latency and Energy saving</a></li><li><a href=../../blog/2022-02-08-dragonbot/>DragonBotOne Egg Hatching with Zenoh and Zenoh-Pico</a></li><li><a href=../../blog/2021-11-09-ros2-zenoh-pico/>ROS 2 and microcontrollers integration via Zenoh-pico</a></li><li><a href=../../blog/2021-10-04-zenoh-pico-guide/>Zenoh goes embedded with zenoh-pico</a></li><li><a href=../../blog/2021-09-28-iac-experiences-from-the-trenches/>Indy Autonomous Challenge (IAC): Experiences from the Trenches</a></li><li><a href=../../blog/2021-07-13-zenoh-performance-async/>Zenoh performance: a stroll in Rust async wonderland</a></li><li><a href=../../blog/2021-07-05-zenoh-overhead/>Zenoh overhead: a story from our community</a></li><li><a href=../../blog/2021-06-14-zenoh-reliability/>Zenoh Reliability, Scalability and Congestion Control</a></li><li><a href=../../blog/2021-04-28-ros2-integration/>Integrating ROS2 with Eclipse zenoh</a></li><li><a href=../../blog/2021-03-23-discovery/>Minimizing Discovery Overhead in ROS2</a></li><li><a href=../../blog/2020-10-08-aithusa/>Zenoh Aithusa Hatched Out!</a></li><li><a href=../../blog/2020-06-29-zenoh-tidings/>Zenoh Tidings</a></li><li><a href=../../blog/2020-01-01-zenohtude/>A Year Full of Zenoh</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 ato-toc"><div class=section-nav><nav id=TableOfContents><ul><li><a href=#namespace-prefix-support>Namespace prefix support</a></li><li><a href=#multicast-ttl-configuration>Multicast TTL Configuration</a></li><li><a href=#configurable-interests-timeout>Configurable Interests Timeout</a></li><li><a href=#improved-link-establishment-timeout>Improved Link Establishment Timeout</a></li><li><a href=#advanced-pubsub-heartbeat>Advanced Pub/Sub Heartbeat</a></li><li><a href=#improved-locator-metadata-syntax>Improved locator metadata syntax</a></li><li><a href=#new-interceptors-and-general-interceptor-framework-improvements>New Interceptors and general interceptor framework improvements</a></li><li><a href=#shared-memory-just-got-better>Shared Memory Just Got Better</a><ul><li><a href=#mutation-examples-in-rust-c-and-c>Mutation Examples in Rust, C, and C++</a></li><li><a href=#performance-boosts>Performance Boosts</a></li><li><a href=#new-configuration-option-for-initialization-behavior>New Configuration Option for Initialization Behavior</a></li></ul></li><li><a href=#resources-consumption-improvements>Resources consumption improvements</a></li></ul><ul><li><a href=#add-p2p-unicast-support>Add p2p unicast support</a></li><li><a href=#connection-restoring>Connection restoring</a></li><li><a href=#querier>Querier</a><ul><li><a href=#declaring-a-querier>Declaring a Querier</a></li><li><a href=#sending-a-query>Sending a Query</a></li><li><a href=#cleaning-up>Cleaning Up</a></li></ul></li><li><a href=#matching-listeners>Matching listeners</a></li><li><a href=#take-from-loaned-operation-for-callbacks>&ldquo;Take from loaned&rdquo; operation for callbacks</a></li></ul><ul><li><a href=#advanced-pub-sub>Advanced Pub Sub</a></li><li><a href=#take-from-loaned-operation-for-callbacks-1>&ldquo;Take from loaned&rdquo; operation for callbacks</a></li><li><a href=#other-api-improvements>Other API improvements</a></li></ul><ul><li><a href=#advanced-pub-sub-1>Advanced Pub Sub</a></li><li><a href=#custom-deleter-for-external-buffer>Custom deleter for external buffer</a></li><li><a href=#other-api-improvements-1>Other API improvements</a></li></ul><ul><li><a href=#query-context-manager>Query context manager</a></li></ul><ul><li><a href=#api-polish-and-alignments>API Polish and alignments</a></li><li><a href=#example-chat-application>Example chat application</a></li></ul><ul><li><a href=#api-polish-and-alignments-1>API Polish and alignments</a></li><li><a href=#maven-publications>Maven Publications</a></li></ul></nav></div></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 ato-content ato-docs"><h1 class=ato-title>Zenoh GozuryÅ« is Here!</h1><p class=ato-date>14th April, 2025 -- Paris.</p><p>We are thrilled to announce the release of Zenoh 1.3.3 â€“ <strong>GozuryÅ«</strong>!</p><p>Named after the legendary &ldquo;Five-Headed Dragon&rdquo;, this release brings a powerful set of new capabilities across the entire Zenoh ecosystem, with improvements touching everything from core routing and shared memory to the language bindings and Zenoh-Pico for constrained devices.</p><p>Letâ€™s dive into the highlights of this release.</p><p><strong>Namespace Prefix Support</strong>: Isolate Zenoh sessions with namespace prefixes â€” ideal for multi-robot and multi-instance setups.</p><p><strong>Peer-to-Peer Unicast in Zenoh-Pico</strong>: Zenoh-Pico now supports direct unicast communication, enabling router-less setups in constrained environments.</p><p><strong>Automatic Reconnect (Zenoh-Pico)</strong>: Sessions can now automatically recover from disconnections, including declaration restoration.</p><p><strong>Shared Memory Performance Boost</strong>: Up to <strong>35% throughput improvements</strong>, with new mutation examples and memory control options.</p><p><strong>Advanced Pub/Sub Enhancements</strong>: Heartbeat support and zero-copy buffer management now available in Zenoh-C and Zenoh-Cpp.</p><p><strong>QoS Rewrite & Filtering Interceptors</strong>: New routing interceptors allow message filtering and QoS adjustments at runtime.</p><p><strong>Resource Usage Optimizations</strong>: Significant reductions in memory and CPU usage, especially on multi-interface systems.</p><p>These are just the highlights â€” Zenoh 1.3.3 comes packed with enhancements across the entire ecosystem, from core protocol upgrades to binding-specific improvements in C, C++, TypeScript, Java/Kotlin, and Zenoh-Pico. In the sections below, weâ€™ll take a closer look at whatâ€™s new, whatâ€™s faster, and whatâ€™s now possible with <strong>GozuryÅ«</strong>.</p><h1 id=zenoh>Zenoh</h1><h2 id=namespace-prefix-support>Namespace prefix support</h2><p>In the latest release we introduced the concept of session namespaces. A namespace can be viewed as a prefix that is automatically prepended to key expressions of all messages that are sent outside of the session. This includes publications, queries, replies, \ subscriber, queryable and liveliness token declarations.</p><p>If we declare a session to have a namespace <code>"my_namespace"</code> and call <code>session.put("my_keyexpr", my_data)</code> then for everyone <em>outside</em> the namespace,i.e., all subscribers declared on sessions without any namespace, this will look like a put on <code>"my_namespace/my_keyexpr"</code>, while subscribers declared for the sessions with same namespace will see it as a put on <code>"my_keyexpr"</code>.</p><p>Let us illustrate this with an example:</p><p>put.rs</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#099>#[tokio::main]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#069;font-weight:700>async</span><span style=color:#bbb> </span><span style=color:#069;font-weight:700>fn</span> <span style=color:#c0f>main</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span><span style=color:#069;font-weight:700>mut</span><span style=color:#bbb> </span>config<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>Config::default();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>config.insert_json5(<span style=color:#c30>&#34;namespace&#34;</span>,<span style=color:#bbb> </span><span style=color:#c30>&#34;\&#34;my_namespace\&#34;&#34;</span>).unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span>session<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>zenoh::open(config).<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>session.put(<span style=color:#c30>&#34;my_keyexpr&#34;</span>,<span style=color:#c30>&#34;my_data&#34;</span>.to_string()).<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>sub_in_namespace.rs</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#099>#[tokio::main]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#069;font-weight:700>async</span><span style=color:#bbb> </span><span style=color:#069;font-weight:700>fn</span> <span style=color:#c0f>main</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span><span style=color:#069;font-weight:700>mut</span><span style=color:#bbb> </span>config<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>Config::default();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>config.insert_json5(<span style=color:#c30>&#34;namespace&#34;</span>,<span style=color:#bbb> </span><span style=color:#c30>&#34;\&#34;my_namespace\&#34;&#34;</span>).unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span>session<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>zenoh::open(config).<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span>subscriber<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>session.declare_subscriber(<span style=color:#c30>&#34;my_keyexpr&#34;</span>).<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>while</span><span style=color:#bbb> </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span><span style=color:#366>Ok</span>(sample)<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>subscriber.recv_async().<span style=color:#069;font-weight:700>await</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>println!(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#c30>&#34;&gt;&gt; [Subscriber] Received (&#39;{}&#39;: &#39;{}&#39;)&#34;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>sample.key_expr().as_str(),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>sample.payload().try_to_string().unwrap(),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>sub_outside_of_namespace.rs</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#099>#[tokio::main]</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#069;font-weight:700>async</span><span style=color:#bbb> </span><span style=color:#069;font-weight:700>fn</span> <span style=color:#c0f>main</span>()<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span><span style=color:#069;font-weight:700>mut</span><span style=color:#bbb> </span>config<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>Config::default();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span>session<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>zenoh::open(config).<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span>subscriber<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>session.declare_subscriber(<span style=color:#c30>&#34;my_namespace/my_keyexpr&#34;</span>).<span style=color:#069;font-weight:700>await</span>.unwrap();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#069;font-weight:700>while</span><span style=color:#bbb> </span><span style=color:#069;font-weight:700>let</span><span style=color:#bbb> </span><span style=color:#366>Ok</span>(sample)<span style=color:#bbb> </span><span style=color:#555>=</span><span style=color:#bbb> </span>subscriber.recv_async().<span style=color:#069;font-weight:700>await</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>println!(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#c30>&#34;&gt;&gt; [Subscriber] Received (&#39;{}&#39;: &#39;{}&#39;)&#34;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>sample.key_expr().as_str(),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>sample.payload().try_to_string().unwrap(),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><p>Both <code>sub_in_namespace.rs</code> and <code>sub_outside_of_namespace.rs</code> will receive the message of <code>put.rs</code>. The former will output:</p><p><code>>> [Subscriber] Received (â€˜my_keyexpr': â€˜my_dataâ€™)</code>, while the latter will output:
<code>>> [Subscriber] Received (â€˜my_namespace/my_keyexprâ€™: â€˜my_dataâ€™)</code>.</p><p>Namespaces can be useful when one needs to avoid name collisions when running the same code on different instances, in multi-robot scenarios for example. Additionally they can be used if isolation between different instances is required, since non-intersecting namespaces will never receive each otherâ€™s messages, since they will start with different prefixes. It is a feature that comes handy when integrating systems too.</p><p>Any string satisfying key expression constraints and not including wildcard chunks (i.e. <code>"*"</code>, <code>"**"</code>, or <code>"$*"</code>) can be used as a namespace.</p><h2 id=multicast-ttl-configuration>Multicast TTL Configuration</h2><p>Multicast communication now supports a configurable TTL (Time-To-Live) parameter. Previously, multicast packets were restricted to a TTL of 1, preventing them from traversing routers. With this update, users can specify a TTL value when establishing a multicast connection, ensuring that traffic can reach beyond a local network. For example:</p><pre tabindex=0><code>./z_pub -m peer -l &#39;udp/239.1.3.37:9001#iface=myinterface;ttl=32&#39; -k &#39;testkey&#39; -p &#39;Hello beyond the router&#39;
</code></pre><h2 id=configurable-interests-timeout>Configurable Interests Timeout</h2><p>The interests protocol timeout, previously hardcoded to 10 seconds, is now configurable via <code>routing.interests.timeout</code>. This allows users to fine-tune interest tracking behavior based on network conditions and application requirements. The default remains 10 seconds, but adjusting this parameter can help optimize message delivery in dynamic environments.</p><h2 id=improved-link-establishment-timeout>Improved Link Establishment Timeout</h2><p>A default timeout for new link establishment has been introduced. While link acceptance already had a 10-second timeout, establishing a new link lacked a similar safeguard. This update ensures that connections do not fail prematurely due to incorrect timeout handling, improving connection stability and retry mechanisms. Default value can be changed via <code>transport.unicast.open_timeout</code> parameter.</p><h2 id=advanced-pubsub-heartbeat>Advanced Pub/Sub Heartbeat</h2><p>Advanced Pub/Sub was introduced in <a href=https://zenoh.io/blog/2024-12-12-zenoh-firesong-1.1.0/#advanced-pubsub>Zenoh v1.1.0</a> to provide end-to-end reliability even in presence of router crashes and networks reconfiguration. In the initial implementation, when using samples sequencing, if the last sent sample was lost and no other samples were published, the AdvancedSubscriber would not detect the miss. One way to address this issue was to enable periodic queries, but those are costly.</p><p>Zenoh version 1.3.3 introduces a <code>heartbeat</code> message that can optionally be sent by the AdvancedPublishers and indicates to the AdvancedSubscribers what are the available samples for recovery. This message can be sent periodically (version 1.3.0) or sporadically (only when new samples are available) with <code>CongestionControl::Block</code> to ensure its reception (version 1.3.2).</p><h2 id=improved-locator-metadata-syntax>Improved locator metadata syntax</h2><p>Link locators support a priority range metadata value (i.e. <code>prio</code>) that instructs Zenoh to use the link in question to transmit messages whose priority falls within the given range. For single-value ranges, you can now write <code>tcp/localhost:0?prio=1</code> instead of <code>tcp/localhost:0?prio=1-1</code> â€” something that proved confusing and unnatural for users.</p><h2 id=new-interceptors-and-general-interceptor-framework-improvements>New Interceptors and general interceptor framework improvements</h2><p>In this release we introduce 2 new interceptor types:</p><ul><li><p>Low-pass filter (configurable through low_pass_filter field in the config) which limits the maximum size of incoming or outgoing messages.</p></li><li><p>QoS Overwrite (configurable through qos/network field in the config) which allows the router (or peer) to overwrite QoS settings of the messages it propagates.</p></li></ul><p>In addition existing interceptor framework received some substantial improvements:</p><ul><li><p>Whenever possible, interceptors now cache the data necessary to process the messages for the given key-expression, which significantly improves their performance.</p></li><li><p>Downsampling interceptor now works with <strong>query</strong> and <strong>reply</strong> message types.</p></li><li><p>All interceptor rules can now be restricted to specific link protocols (i.e. one can define rules which are only applied to TCP or TLS links for example).</p></li></ul><h2 id=shared-memory-just-got-better>Shared Memory Just Got Better</h2><p>The shared memory subsystem, first introduced in <a href=https://zenoh.io/blog/2024-10-21-zenoh-firesong/>Zenoh v1.0.0</a>, continues to evolve with new improvements and optimizations aimed at performance and flexibility.</p><h3 id=mutation-examples-in-rust-c-and-c>Mutation Examples in Rust, C, and C++</h3><p>First up: weâ€™ve added mutation examples for shared memory buffers in <a href=https://github.com/eclipse-zenoh/zenoh/blob/94e917948914af093eae340ee52118b19fb1671f/examples/examples/z_sub_shm.rs#L91>Rust</a>, <a href=https://github.com/eclipse-zenoh/zenoh-c/blob/18eed6fecf2c52e8c822b3b8c77d92f620b6e120/examples/z_sub_shm.c#L50>C</a>, and <a href=https://github.com/eclipse-zenoh/zenoh-cpp/blob/e3f9bfc977a72a03668537eca6f03e4bbbe130c7/examples/zenohc/z_sub_shm.cxx#L58>C++</a>.
These examples extend our common <code>z_sub_shm</code> demo, adding a mutation attempt to show whether the received buffer is actually mutable. This gives developers more insight into how to handle SHM buffer mutation functionality.</p><h3 id=performance-boosts>Performance Boosts</h3><p>Weâ€™ve also done a lot of under-the-hood optimization. By reducing computational complexity and memory footprint in the SHM internals, weâ€™ve managed to boost message-per-second performance by a solid <strong>35%</strong>.</p><h3 id=new-configuration-option-for-initialization-behavior>New Configuration Option for Initialization Behavior</h3><p>Previously, SHM internal resources were always initialized lazilyâ€”the first time your application touched shared memory (typically on the first buffer allocation or reception). This approach worked well for most use cases, keeping memory usage and startup time low. But it introduced a one-time latency spike that wasnâ€™t ideal in latency-sensitive scenarios.</p><p>Now, weâ€™ve introduced a <a href=https://github.com/eclipse-zenoh/zenoh/blob/94e917948914af093eae340ee52118b19fb1671f/DEFAULT_CONFIG.json5#L681>new configuration option</a> to give you control over SHM initialization behavior. You can choose between lazy or eager initialization, depending on what best fits your application.</p><h2 id=resources-consumption-improvements>Resources consumption improvements</h2><p>Some major reduction of CPU and memory consumption have been introduced that allow for better scalability.</p><ul><li><p>Network interface scanning to compute locators is a very CPU expensive task that is now only performed once at startup.</p></li><li><p>Various improvements have been made in the routing to decrease CPU and memory consumption.</p></li><li><p>Changes have been made in the default size and allocation policies of the Zenoh internal queues that significantly decrease memory consumption.</p></li></ul><p>Here is a graph of CPU and memory consumption running a Zenoh router and 100 ROS2 nodes (50 publishers and 50 subscribers) on a same host (4 cores 8GB RAM):</p><p><img src=../../img/20250414-zenoh-gozuryu/zenoh_perf.png alt="CPU and memory consumption"></p><h1 id=zenoh-pico>Zenoh-Pico</h1><h2 id=add-p2p-unicast-support>Add p2p unicast support</h2><p>In the latest release, we have introduced peer-to-peer (P2P) unicast support in Zenoh-Pico, allowing applications to establish unicast links without the need for a central router â€“ thus far, peer-to-peer was only available in combination with the use of UDP multicast.</p><p>This is particularly beneficial in scenarios where reliability, low-latency and high-throughput communication are crucial.</p><p>This addition aligns with Zenoh-Pico&rsquo;s goal of providing robust communication solutions for constrained devices, further expanding its use cases in IoT and embedded.</p><p>A blog post will go into more detail about the feature and its limitations but if you want to try it right now:</p><p>First, run a Zenoh-pico example on your machine as a tcp server:</p><p><code>./build/examples/z_sub -m peer -l tcp/127.0.0.1:7447</code></p><p>And run a few other examples as clients:</p><p><code>./build/examples/z_pub -m peer -e tcp/127.0.0.1:7447</code></p><h2 id=connection-restoring>Connection restoring</h2><p>When network disruptions occur, whether due to temporary connectivity issues or router restarts, Zenoh-Pico now automatically attempts to restore its connection. This new functionality, introduced under the <code>Z_FEATURE_AUTO_RECONNECT</code> flag (enabled by default), enhances reliability by detecting lost connections and seamlessly reestablishing them. Additionally, it caches declarations and restores them after reconnection, ensuring a smooth recovery without manual intervention. With this improvement, applications using Zenoh-Pico can handle transient failures more gracefully, reducing the risk of silent data loss and aligning Zenoh-Picoâ€™s resilience more closely with Zenoh. For memory-constrained environments, the feature can be disabled to optimize resource usage.</p><h2 id=querier>Querier</h2><p>Zenoh-Pico now supports queriers, bringing query-side optimizations similar to those available for publishers. Just as publishers enable Zenoh to optimize continuous data dissemination, queriers allow for efficient, stateful querying with features like write-side filtering and matching status. This addition enhances Zenoh-Picoâ€™s ability to interact with distributed systems while maintaining minimal resource usage.</p><h3 id=declaring-a-querier>Declaring a Querier</h3><p>A querier can be declared on a specific key expression, allowing queries to be issued dynamically:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>z_owned_querier_t querier;
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>if</span> (z_declare_querier(z_loan(s), <span style=color:#555>&amp;</span>querier, z_loan(keyexpr), <span style=color:#366>NULL</span>) <span style=color:#555>&lt;</span> <span style=color:#f60>0</span>) {
</span></span><span style=display:flex><span>    printf(<span style=color:#c30>&#34;Unable to declare Querier for key expression!</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
</span></span><span style=display:flex><span>    exit(<span style=color:#555>-</span><span style=color:#f60>1</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=sending-a-query>Sending a Query</h3><p>Once declared, a querier can retrieve data from matching queryables in the system. Replies are handled asynchronously through a callback:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#078;font-weight:700>void</span> <span style=color:#c0f>reply_handler</span>(z_loaned_reply_t <span style=color:#555>*</span>reply, <span style=color:#078;font-weight:700>void</span> <span style=color:#555>*</span>ctx) {
</span></span><span style=display:flex><span>      <span style=color:#069;font-weight:700>if</span> (z_reply_is_ok(reply)) {
</span></span><span style=display:flex><span>          <span style=color:#069;font-weight:700>const</span> z_loaned_sample_t <span style=color:#555>*</span>sample <span style=color:#555>=</span> z_reply_ok(reply);
</span></span><span style=display:flex><span>          z_view_string_t keystr;
</span></span><span style=display:flex><span>          z_keyexpr_as_view_string(z_sample_keyexpr(sample), <span style=color:#555>&amp;</span>keystr);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          printf(<span style=color:#c30>&#34;&gt;&gt; Received &#39;%.*s&#39;</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>,
</span></span><span style=display:flex><span>                 z_string_len(z_loan(keystr)),
</span></span><span style=display:flex><span>                 z_string_data(z_loan(keystr)));
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>z_owned_closure_reply_t callback;
</span></span><span style=display:flex><span>z_closure(<span style=color:#555>&amp;</span>callback, reply_handler, <span style=color:#366>NULL</span>, <span style=color:#366>NULL</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>z_querier_get(z_loan(querier), params, z_move(closure), <span style=color:#366>NULL</span>);
</span></span></code></pre></div><h3 id=cleaning-up>Cleaning Up</h3><p>When no longer needed, the querier should be undeclared to release resources:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>z_drop(z_move(querier));
</span></span></code></pre></div><p>A full example as well as working with the channel can be found <a href=https://github.com/eclipse-zenoh/zenoh-pico/blob/main/examples/unix/c11/z_querier.c>there</a>.</p><h2 id=matching-listeners>Matching listeners</h2><p>Zenoh-Pico now supports matching listeners, allowing publishers and queriers to detect when there are active subscribers or queriable matching their key expression. This feature provides applications with greater awareness of their communication state, optimizing resource usage and enabling more responsive behavior. The same functionality is also available in Zenoh-Cpp, ensuring consistency across implementations.</p><p>A matching listener can be declared using <code>z_publisher_declare_background_matching_listener</code>, which registers a callback that is triggered when the first subscriber connects or when the last subscriber disconnects:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#078;font-weight:700>void</span> <span style=color:#c0f>matching_status_handler</span>(<span style=color:#069;font-weight:700>const</span> z_matching_status_t <span style=color:#555>*</span>matching_status, <span style=color:#078;font-weight:700>void</span> <span style=color:#555>*</span>arg) {
</span></span><span style=display:flex><span>    (<span style=color:#078;font-weight:700>void</span>)arg;
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>if</span> (matching_status<span style=color:#555>-&gt;</span>matching) {
</span></span><span style=display:flex><span>        printf(<span style=color:#c30>&#34;Publisher has matching subscribers.</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
</span></span><span style=display:flex><span>    } <span style=color:#069;font-weight:700>else</span> {
</span></span><span style=display:flex><span>        printf(<span style=color:#c30>&#34;Publisher has NO MORE matching subscribers.</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>z_owned_closure_matching_status_t callback;
</span></span><span style=display:flex><span>z_closure(<span style=color:#555>&amp;</span>callback, matching_status_handler, <span style=color:#366>NULL</span>, <span style=color:#366>NULL</span>);
</span></span><span style=display:flex><span>z_publisher_declare_background_matching_listener(z_loan(pub), z_move(callback));
</span></span></code></pre></div><p>Alternatively, for more control, <code>z_publisher_declare_matching_listener</code> can be used, which allows explicit management of the listener&rsquo;s lifecycle.</p><h2 id=take-from-loaned-operation-for-callbacks>&ldquo;Take from loaned&rdquo; operation for callbacks</h2><p>See the same-named section for Zenoh-C, the Zenoh-Pico API was updated in the same way.</p><h1 id=zenoh-c>Zenoh-C</h1><h2 id=advanced-pub-sub>Advanced Pub Sub</h2><p>We are happy to share that Zenoh-C now supports <a href=%5Bhttps://zenoh.io/blog/2024-12-12-zenoh-firesong-1.1.0/#advanced-pubsub%5D(https://zenoh.io/blog/2024-12-12-zenoh-firesong-1.1.0/#advanced-pubsub)>Advanced Pub/Sub API</a> introduced in Zenoh 1.1.0.</p><p>z_advanced_pub.c</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>z_owned_config_t config;
</span></span><span style=display:flex><span>z_config_default(<span style=color:#555>&amp;</span>config);
</span></span><span style=display:flex><span>zc_config_insert_json5(
</span></span><span style=display:flex><span>    z_loan_mut(config), Z_CONFIG_ADD_TIMESTAMP_KEY, <span style=color:#c30>&#34;true&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>z_owned_session_t s;
</span></span><span style=display:flex><span>z_open(<span style=color:#555>&amp;</span>s, z_move(config), <span style=color:#366>NULL</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>z_view_keyexpr_t ke;
</span></span><span style=display:flex><span>z_view_keyexpr_from_str(<span style=color:#555>&amp;</span>ke, <span style=color:#c30>&#34;key/expression&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ze_advanced_publisher_options_t pub_opts;
</span></span><span style=display:flex><span>ze_advanced_publisher_options_default(<span style=color:#555>&amp;</span>pub_opts);
</span></span><span style=display:flex><span>pub_opts.cache.is_enabled <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>pub_opts.cache.max_samples <span style=color:#555>=</span> <span style=color:#f60>10</span>;
</span></span><span style=display:flex><span>pub_opts.publisher_detection <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>pub_opts.sample_miss_detection.is_enabled <span style=color:#555>=</span> <span style=color:#366>true</span>
</span></span><span style=display:flex><span>pub_opts.sample_miss_detection.heartbeat_period_ms <span style=color:#555>=</span> <span style=color:#f60>500</span>;
</span></span><span style=display:flex><span>pub_opts.sample_miss_detection.heartbeat_mode <span style=color:#555>=</span> ZE_ADVANCED_PUBLISHER_HEARTBEAT_MODE_PERIODIC;
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>// if not set, publisher will retransmit samples based on periodic queries from advanced subscriber
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>
</span></span><span style=display:flex><span>ze_owned_advanced_publisher_t pub;
</span></span><span style=display:flex><span>ze_declare_advanced_publisher(z_loan(s), <span style=color:#555>&amp;</span>pub, z_loan(ke), <span style=color:#555>&amp;</span>pub_opts);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>z_owned_bytes_t payload;
</span></span><span style=display:flex><span>z_bytes_copy_from_str(<span style=color:#555>&amp;</span>payload, <span style=color:#c30>&#34;some_data&#34;</span>);
</span></span><span style=display:flex><span>ze_advanced_publisher_put(z_loan(pub), z_move(payload), <span style=color:#366>NULL</span>);
</span></span></code></pre></div><p>z_advanced_sub.c</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#078;font-weight:700>void</span> <span style=color:#c0f>data_handler</span>(z_loaned_sample_t<span style=color:#555>*</span> sample, <span style=color:#078;font-weight:700>void</span><span style=color:#555>*</span> arg) {
</span></span><span style=display:flex><span>    z_view_string_t key_string;
</span></span><span style=display:flex><span>    z_keyexpr_as_view_string(z_sample_keyexpr(sample), <span style=color:#555>&amp;</span>key_string);
</span></span><span style=display:flex><span>    z_owned_string_t payload_string;
</span></span><span style=display:flex><span>    z_bytes_to_string(z_sample_payload(sample), <span style=color:#555>&amp;</span>payload_string);
</span></span><span style=display:flex><span>    printf(<span style=color:#c30>&#34;&gt;&gt; [Subscriber] Received (&#39;%.*s&#39;: &#39;%.*s&#39;)</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>,
</span></span><span style=display:flex><span>        (<span style=color:#078;font-weight:700>int</span>)z_string_len(z_loan(key_string)),
</span></span><span style=display:flex><span>        z_string_data(z_loan(key_string)),
</span></span><span style=display:flex><span>        (<span style=color:#078;font-weight:700>int</span>)z_string_len(z_loan(payload_string)),
</span></span><span style=display:flex><span>        z_string_data(z_loan(payload_string)));
</span></span><span style=display:flex><span>    z_drop(z_move(payload_string));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#078;font-weight:700>void</span> <span style=color:#c0f>miss_handler</span>(<span style=color:#069;font-weight:700>const</span> ze_miss_t<span style=color:#555>*</span> miss, <span style=color:#078;font-weight:700>void</span><span style=color:#555>*</span> arg) {
</span></span><span style=display:flex><span>    z_id_t id <span style=color:#555>=</span> z_entity_global_id_zid(<span style=color:#555>&amp;</span>miss<span style=color:#555>-&gt;</span>source);
</span></span><span style=display:flex><span>    z_owned_string_t id_string;
</span></span><span style=display:flex><span>    z_id_to_string(<span style=color:#555>&amp;</span>id, <span style=color:#555>&amp;</span>id_string);
</span></span><span style=display:flex><span>    printf(<span style=color:#c30>&#34;&gt;&gt; [Subscriber] Missed %d samples from &#39;%.*s&#39; !!!&#34;</span>,
</span></span><span style=display:flex><span>        miss<span style=color:#555>-&gt;</span>nb, (<span style=color:#078;font-weight:700>int</span>)z_string_len(z_loan(id_string)),
</span></span><span style=display:flex><span>        z_string_data(z_loan(id_string)));
</span></span><span style=display:flex><span>    z_drop(z_move(id_string));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>z_owned_config_t config;
</span></span><span style=display:flex><span>z_config_default(<span style=color:#555>&amp;</span>config);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>z_owned_session_t session;
</span></span><span style=display:flex><span>z_open(<span style=color:#555>&amp;</span>session, z_move(config), <span style=color:#366>NULL</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>z_view_keyexpr_t ke;
</span></span><span style=display:flex><span>z_view_keyexpr_from_str(<span style=color:#555>&amp;</span>ke, <span style=color:#c30>&#34;key/expression&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ze_advanced_subscriber_options_t sub_opts;
</span></span><span style=display:flex><span>ze_advanced_subscriber_options_default(<span style=color:#555>&amp;</span>sub_opts);
</span></span><span style=display:flex><span>sub_opts.history.is_enabled <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>sub_opts.history.detect_late_publishers <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>sub_opts.recovery.is_enabled <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>sub_opts.recovery.last_sample_miss_detection.is_enabled <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>// use publisher heartbeats by default, otherwise enable periodic queries as follows:
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>// sub_opts.recovery.last_sample_miss_detection.periodic_queries_period_ms = 1000;
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>sub_opts.subscriber_detection <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>z_owned_closure_sample_t callback;
</span></span><span style=display:flex><span>z_closure(<span style=color:#555>&amp;</span>callback, data_handler, <span style=color:#366>NULL</span>, <span style=color:#366>NULL</span>);
</span></span><span style=display:flex><span>ze_owned_advanced_subscriber_t sub;
</span></span><span style=display:flex><span>ze_declare_advanced_subscriber(
</span></span><span style=display:flex><span>    z_loan(session), <span style=color:#555>&amp;</span>sub, z_loan(ke),
</span></span><span style=display:flex><span>    z_move(callback), <span style=color:#555>&amp;</span>sub_opts);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ze_owned_closure_miss_t miss_callback;
</span></span><span style=display:flex><span>z_closure(<span style=color:#555>&amp;</span>miss_callback, miss_handler, <span style=color:#366>NULL</span>, <span style=color:#366>NULL</span>);
</span></span><span style=display:flex><span>ze_advanced_subscriber_declare_background_sample_miss_listener(
</span></span><span style=display:flex><span>    z_loan(sub), z_move(miss_callback));
</span></span></code></pre></div><p>Complete examples can be found at <a href=https://github.com/eclipse-zenoh/zenoh-c/blob/main/examples/z_advanced_pub.c>z_advanced_pub.c</a> and <a href=https://github.com/eclipse-zenoh/zenoh-c/blob/main/examples/z_advanced_sub.c>z_advanced_sub.c</a>.</p><p><strong>ze_querying_subscriber</strong> and <strong>ze_publication_cache</strong> APIs are now marked as deprecated.</p><h2 id=take-from-loaned-operation-for-callbacks-1>&ldquo;Take from loaned&rdquo; operation for callbacks</h2><p>The Zenoh-C API makes a strong distinction between &ldquo;moved&rdquo; and &ldquo;loaned&rdquo; arguments of functions inspired by Rust and introduced to increase code safety. Assume that we define the structure</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>z_owned_foo_t foo;
</span></span></code></pre></div><p>Below are the variants of how this structure is processed depending on function parameter type:</p><table><thead><tr><th>Function declaration</th><th>How to call</th><th>Meaning</th></tr></thead><tbody><tr><td>void new_foo(z_owned_foo_t* foo);</td><td>new_foo(&foo);</td><td>Construct a new &ldquo;foo&rdquo; object; assumes that the structure foo is undefined</td></tr><tr><td>bool read_foo(const z_loaned_foo_t* foo);</td><td>read_foo(z_loan(foo));</td><td>Reads data from &ldquo;foo&rdquo;, never changes it</td></tr><tr><td>void update_foo(z_loaned_foo_t* foo);</td><td>update_foo(z_loan_mut(foo));</td><td>May modify &ldquo;foo&rdquo;, but guarantees that &ldquo;foo&rdquo; is valid after the call</td></tr><tr><td>void take_foo(z_moved_foo_t* foo);</td><td>take_foo(z_move(foo));</td><td>Takes ownership of data contained in foo. Guarantees that after calling this function the foo is left in the empty state and should not be accessed anymore (but z_drop on it is allowed, i.e., the API is double-drop safe)</td></tr></tbody></table><p>See the Zenoh-C &ldquo;Concepts&rdquo; section of documentation for more detailed explanations: <a href=https://zenoh-c.readthedocs.io/en/1.3.2/concepts.html>https://zenoh-c.readthedocs.io/en/1.3.2/concepts.html</a>.</p><p>It happened that this approach doesnâ€™t work well with parameters of callback functions. Ideally the callback functions should have accepted the <code>z_moved_foo_t *</code> type. E.g., callback receives a sample and the user is allowed to take this sample and place it to some queue for further processing.</p><p>The problem is that <code>z_moved_foo_t *</code> type obliges function to take ownership of the parameter. But sometimes users just want to read and analyze data in place, they donâ€™t want to care about the lifetime of the passed data.</p><p>So, it was decided that callback functions accepts parameter of <code>z_loaned_foo_t *</code> type and in this release the new operation <code>z_take_from_loaned</code> was introduced. Here is the example of its usage:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#078;font-weight:700>void</span> <span style=color:#c0f>sub_callback</span>(z_loaned_sample_t<span style=color:#555>*</span> sample, <span style=color:#078;font-weight:700>void</span><span style=color:#555>*</span> arg) {
</span></span><span style=display:flex><span>  z_owned_sample_t s;
</span></span><span style=display:flex><span>  z_take_from_loaned(<span style=color:#555>&amp;</span>s, sample);
</span></span><span style=display:flex><span>  <span style=color:#09f;font-style:italic>// Now we can save `s` for further processing, e.g. send it to another thread
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>}
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>z_owned_closure_sample_t callback;
</span></span><span style=display:flex><span>z_closure(<span style=color:#555>&amp;</span>callback, sub_callback, <span style=color:#366>NULL</span>, <span style=color:#366>NULL</span>);
</span></span><span style=display:flex><span>z_owned_subscriber_t sub;
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>if</span> (z_declare_subscriber(z_loan(session), <span style=color:#555>&amp;</span>sub, z_loan(keyexpr), z_move(callback), <span style=color:#366>NULL</span>) <span style=color:#555>&lt;</span> <span style=color:#f60>0</span>) {
</span></span><span style=display:flex><span>  printf(<span style=color:#c30>&#34;Unable to declare subscriber.</span><span style=color:#c30;font-weight:700>\n</span><span style=color:#c30>&#34;</span>);
</span></span><span style=display:flex><span>  exit(<span style=color:#555>-</span><span style=color:#f60>1</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Itâ€™s important to notice that the <code>z_take_from_loaned</code> function breaks the condition <em>&ldquo;function, accepting z_loaned_foo_t</em> type guarantees that &ldquo;foo&rdquo; is valid after the call&rdquo;* . Thatâ€™s why this operation is reserved to be used only by developers and itâ€™s strongly discouraged to use it outside of callbacks. The functions of Zenoh-C API itself never perform this operation.</p><h2 id=other-api-improvements>Other API improvements</h2><p>We introduced the <code>z_bytes_get_contiguous_view</code> function allowing to get a view (i.e. a pointer and length) of the payload bytes, for contiguous payloads. This function will return an error if payload is not contiguous (most likely due to fragmentation if payload size is too big) - in this case to access payload data without copy one can continue to use either <strong>z_bytes_reader</strong> API or <strong>z_bytes_slice_iterator</strong> API.</p><p>get_contiguous_view.c</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>z_view_slice_t view;
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>if</span> (z_bytes_get_contiguous_view(z_loan(payload), <span style=color:#555>&amp;</span>view) <span style=color:#555>==</span> Z_OK) {
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>const</span> <span style=color:#078;font-weight:700>uint8_t</span><span style=color:#555>*</span> ptr <span style=color:#555>=</span> z_slice_data(z_loan(view));
</span></span><span style=display:flex><span>    size_t len <span style=color:#555>=</span> z_slice_len(z_loan(view));
</span></span><span style=display:flex><span>    <span style=color:#09f;font-style:italic>// do something with ptr and len
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>}
</span></span></code></pre></div><h1 id=zenoh-cpp>Zenoh-Cpp</h1><h2 id=advanced-pub-sub-1>Advanced Pub Sub</h2><p><a href=https://zenoh.io/blog/2024-12-12-zenoh-firesong-1.1.0/#advanced-pubsub>Advanced Pub/Sub API</a> introduced in Zenoh 1.1.0 is now also available in Zenoh-Cpp, but for the time being only with <strong>Zenoh-C</strong> backend:</p><p>z_advanced_pub.cpp</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> config <span style=color:#555>=</span> Config<span style=color:#555>::</span>create_default();
</span></span><span style=display:flex><span>config.insert_json5(Z_CONFIG_ADD_TIMESTAMP_KEY, <span style=color:#c30>&#34;true&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> session <span style=color:#555>=</span> Session<span style=color:#555>::</span>open(std<span style=color:#555>::</span>move(config));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ext<span style=color:#555>::</span>SessionExt<span style=color:#555>::</span>AdvancedPublisherOptions opts;
</span></span><span style=display:flex><span>opts.cache.emplace().max_samples <span style=color:#555>=</span> <span style=color:#f60>10</span>;
</span></span><span style=display:flex><span>opts.publisher_detection <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>opts.sample_miss_detection.emplace().heartbeat <span style=color:#555>=</span>
</span></span><span style=display:flex><span>ext<span style=color:#555>::</span>SessionExt<span style=color:#555>::</span>AdvancedPublisherOptions<span style=color:#555>::</span>SampleMissDetectionOptions<span style=color:#555>::</span>HeartbeatPeriodic{<span style=color:#f60>1000</span>};
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>// alternatively sample miss detection can be done in response to subscriber&#39;s periodic queries
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> pub <span style=color:#555>=</span> session.ext().declare_advanced_publisher(
</span></span><span style=display:flex><span>    <span style=color:#c30>&#34;key/expression&#34;</span>, std<span style=color:#555>::</span>move(opts));
</span></span><span style=display:flex><span>pub.put(<span style=color:#c30>&#34;some_data&#34;</span>);
</span></span></code></pre></div><p>z_advanced_sub.cpp</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> config <span style=color:#555>=</span> Config<span style=color:#555>::</span>create_default();
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> session <span style=color:#555>=</span> Session<span style=color:#555>::</span>open(std<span style=color:#555>::</span>move(config));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ext<span style=color:#555>::</span>SessionExt<span style=color:#555>::</span>AdvancedSubscriberOptions opts;
</span></span><span style=display:flex><span>opts.history.emplace().detect_late_publishers <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>opts.history<span style=color:#555>-&gt;</span>detect_late_publishers <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>// enable recovery based on received heartbeats from ext::AdvancedPublisher
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>opts.recovery.emplace().last_sample_miss_detection <span style=color:#555>=</span>
</span></span><span style=display:flex><span>ext<span style=color:#555>::</span>SessionExt<span style=color:#555>::</span>AdvancedSubscriberOptions<span style=color:#555>::</span>RecoveryOptions<span style=color:#555>::</span>Heartbeat{};
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>// alternatively recovery can be triggered based on missed sample detection via periodic queries:
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>// opts.recovery.emplace().last_sample_miss_detection =
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>// ext::SessionExt::AdvancedSubscriberOptions::RecoveryOptions::PeriodicQueriesOptions{1000};
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>opts.subscriber_detection <span style=color:#555>=</span> <span style=color:#366>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> data_handler <span style=color:#555>=</span> [](<span style=color:#069;font-weight:700>const</span> Sample <span style=color:#555>&amp;</span>sample) {
</span></span><span style=display:flex><span>   std<span style=color:#555>::</span>cout <span style=color:#555>&lt;&lt;</span> <span style=color:#c30>&#34;&gt;&gt; [Subscriber] Received (&#39;&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#555>&lt;&lt;</span> sample.get_keyexpr().as_string_view() <span style=color:#555>&lt;&lt;</span> <span style=color:#c30>&#34;&#39; : &#39;&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#555>&lt;&lt;</span> sample.get_payload().as_string() <span style=color:#555>&lt;&lt;</span> <span style=color:#c30>&#34;&#39;)&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#555>&lt;&lt;</span> std<span style=color:#555>::</span>endl;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> missed_sample_handler <span style=color:#555>=</span> [](<span style=color:#069;font-weight:700>const</span> ext<span style=color:#555>::</span>Miss <span style=color:#555>&amp;</span>miss) {
</span></span><span style=display:flex><span>    std<span style=color:#555>::</span>cout <span style=color:#555>&lt;&lt;</span> <span style=color:#c30>&#34;&gt;&gt; [Subscriber] Missed &#34;</span> <span style=color:#555>&lt;&lt;</span> miss.nb
</span></span><span style=display:flex><span>              <span style=color:#555>&lt;&lt;</span> <span style=color:#c30>&#34; samples from &#39;&#34;</span> <span style=color:#555>&lt;&lt;</span> miss.source.id() <span style=color:#555>&lt;&lt;</span> <span style=color:#c30>&#34;&#39; !!!&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#555>&lt;&lt;</span> std<span style=color:#555>::</span>endl;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> advanced_subscriber <span style=color:#555>=</span>
</span></span><span style=display:flex><span>session.ext().declare_advanced_subscriber(
</span></span><span style=display:flex><span>    <span style=color:#c30>&#34;key/expression&#34;</span>, data_handler, closures<span style=color:#555>::</span>none, std<span style=color:#555>::</span>move(opts));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>advanced_subscriber.declare_background_sample_miss_listener(
</span></span><span style=display:flex><span>    missed_sample_handler, closures<span style=color:#555>::</span>none);
</span></span></code></pre></div><p>Complete examples can be found at <a href=https://github.com/eclipse-zenoh/zenoh-cpp/blob/main/examples/zenohc/z_advanced_pub.cxx>z_advanced_pub.cpp</a> and <a href=https://github.com/eclipse-zenoh/zenoh-cpp/blob/main/examples/zenohc/z_advanced_sub.cxx>z_advanced_sub.cpp</a>.</p><p><strong>ext::QueryingSubscriber</strong> and <strong>ext::PublicationCache</strong> APIs are now marked as deprecated.</p><h2 id=custom-deleter-for-external-buffer>Custom deleter for external buffer</h2><p>Sometimes itâ€™s necessary to send a large amount of data, which can be inefficient to copy. However, the exact moment when Zenoh deletes the <code>Buffer</code> object is unknown: after being sent, the buffer is queued and only deleted once it has actually been transmitted.</p><p>It is possible to create a <code>Bytes</code> object by moving a <code>std::vector</code> into it, thereby avoiding a copy of the vector. However, this approach does not cover all use cases.</p><p>Now, it is possible to create a <code>Buffer</code> object that points to external data and uses a custom deleter for that data. When Zenoh finishes sending the buffer, it destroys the <code>Buffer</code> object, and its destructor invokes the custom deleter. See the example below:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#078;font-weight:700>uint8_t</span><span style=color:#555>*</span> ptr <span style=color:#555>=</span> <span style=color:#069;font-weight:700>new</span> <span style=color:#078;font-weight:700>uint8_t</span>[<span style=color:#f60>10</span>];
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> deleter <span style=color:#555>=</span> [<span style=color:#555>&amp;</span>deleted](<span style=color:#078;font-weight:700>uint8_t</span><span style=color:#555>*</span> data) {
</span></span><span style=display:flex><span>  <span style=color:#069;font-weight:700>delete</span>[] data;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Bytes <span style=color:#c0f>bytes</span>(ptr, <span style=color:#f60>10</span>, deleter);
</span></span><span style=display:flex><span>session.put(<span style=color:#c30>&#34;foo/bar&#34;</span>, std<span style=color:#555>::</span>move(bytes));
</span></span></code></pre></div><h2 id=other-api-improvements-1>Other API improvements</h2><p>We introduced <code>Bytes::get_contiguous_view()</code> method allowing to get a view (i.e. a pointer and length) of the payload bytes, for contiguous payloads. This function will return an empty <code>std::optional</code> if payload is not contiguous (most likely due to fragmentation, if payload size is too big) - in this case to access payload data without copy one can continue to use either <strong>Bytes::Reader</strong> or <strong>Bytes::SliceIterator</strong>.</p><p>get_contiguous_view.cpp</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#069;font-weight:700>auto</span> view <span style=color:#555>=</span> payload.get_contiguous_view();
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>if</span> (view.has_value()) {
</span></span><span style=display:flex><span>    <span style=color:#069;font-weight:700>const</span> <span style=color:#078;font-weight:700>uint8_t</span><span style=color:#555>*</span> ptr <span style=color:#555>=</span> view.data;
</span></span><span style=display:flex><span>    size_t len <span style=color:#555>=</span> view.len;
</span></span><span style=display:flex><span>    <span style=color:#09f;font-style:italic>// do something with ptr and len
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>}
</span></span></code></pre></div><h1 id=zenoh-python>Zenoh-Python</h1><h2 id=query-context-manager>Query context manager</h2><p>When using queryable with a channel handler, query objects need to be finalized in order to acknowledge the query response on the querier side. The proper way to do this in Python is by using a context manager, thatâ€™s why Query objects can now be used as context managers.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#069;font-weight:700>with</span> zenoh<span style=color:#555>.</span>open(conf) <span style=color:#069;font-weight:700>as</span> session:
</span></span><span style=display:flex><span>   <span style=color:#366>print</span>(<span style=color:#c30>f</span><span style=color:#c30>&#34;Declaring Queryable on &#39;</span><span style=color:#a00>{</span>key<span style=color:#a00>}</span><span style=color:#c30>&#39;...&#34;</span>)
</span></span><span style=display:flex><span>   queryable <span style=color:#555>=</span> session<span style=color:#555>.</span>declare_queryable(key, complete<span style=color:#555>=</span>complete)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#366>print</span>(<span style=color:#c30>&#34;Press CTRL-C to quit...&#34;</span>)
</span></span><span style=display:flex><span>   <span style=color:#069;font-weight:700>while</span> <span style=color:#069;font-weight:700>True</span>:
</span></span><span style=display:flex><span>       <span style=color:#069;font-weight:700>with</span> queryable<span style=color:#555>.</span>recv() <span style=color:#069;font-weight:700>as</span> query:  <span style=color:#09f;font-style:italic># use the context manager here</span>
</span></span><span style=display:flex><span>           <span style=color:#09f;font-style:italic># do something with query</span>
</span></span></code></pre></div><h1 id=zenoh-ts>Zenoh-TS</h1><h2 id=api-polish-and-alignments>API Polish and alignments</h2><p>In version 1.3.3 we have made some upgrades to the inner workings of the Typescript API, specifically we have added a <strong>KeyExpr</strong> API based on the Rust Zenoh-KeyExpr library, compiling a subset of the KeyExpr library to WASM. This is a first step on the path of integration and code reuse between main Zenoh and Zenoh typescript binding.</p><p>We have also exposed the ability to get session info in a poll-based fashion.
Note that due to the TS implementation being based on a remote API, every time a user requires the most up to date version of the session info, a new call to session info will have to be made, producing a new <code>SessionInfo</code> class instance.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>console.log<span style=color:#555>!</span>(<span style=color:#c30>&#34;Opening session...&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>const</span> session <span style=color:#555>=</span> <span style=color:#069;font-weight:700>await</span> Session.open(<span style=color:#069;font-weight:700>new</span> Config(<span style=color:#c30>&#34;ws/127.0.0.1:10000&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>console.log<span style=color:#555>!</span>(<span style=color:#c30>&#34;Get Info...&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>const</span> info: <span style=color:#078;font-weight:700>SessionInfo</span> <span style=color:#555>=</span> <span style=color:#069;font-weight:700>await</span> session.info();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>console.log<span style=color:#555>!</span>(<span style=color:#c30>&#34;zid: {}&#34;</span>, info.zid());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>console.log<span style=color:#555>!</span>(<span style=color:#c30>&#34;routers zid: {:?}&#34;</span>,info.routers_zid() );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>console.log<span style=color:#555>!</span>(<span style=color:#c30>&#34;peers zid: {:?}&#34;</span>,info.peers_zid() );
</span></span><span style=display:flex><span><span style=color:#09f;font-style:italic>// New SessionInfo object will need to be created here for updated state
</span></span></span></code></pre></div><p>Multiple minor changes in the Typescript API have been made in order to cover main Zenoh functionality and to make Typescript API better matching with other language bindings as well as to make it internally consistent:</p><ul><li><p>The <code>callback</code> field was renamed to <code>handler</code> as it was supposed to contain a callback function or channel. This field now is always passed in corresponding &ldquo;options&rdquo; structure for API uniformity</p></li><li><p><code>options</code> structures with additional parameters like <code>encoding</code>, <code>attachment</code>, <code>priority</code>, etc were added to <code>reply()</code>, <code>reply_err()</code> and <code>reply_del()</code> operations of <code>Query</code></p></li><li><p>Channels&rsquo; fields <code>size</code> were renamed to <code>capacity</code></p></li><li><p>Encodingâ€™s <code>from_str</code> renamed to <code>from_string</code>,</p></li><li><p><code>with_schema()</code> method added to Encoding</p></li></ul><p>Binary data serialization compatible with the zenoh-ext library was implemented. Now itâ€™s possible to exchange data between Zenoh applications on typescript and other languages. The example of using serialization/deserialization API:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#069;font-weight:700>let</span> input <span style=color:#555>=</span> <span style=color:#069;font-weight:700>new</span> Map&lt;<span style=color:#309;font-weight:700>bigint</span><span style=color:#a00;background-color:#faa>,</span> <span style=color:#309>string</span>&gt;()
</span></span><span style=display:flex><span>input.<span style=color:#069;font-weight:700>set</span>(<span style=color:#f60>0</span>n, <span style=color:#c30>&#34;abc&#34;</span>)
</span></span><span style=display:flex><span>input.<span style=color:#069;font-weight:700>set</span>(<span style=color:#f60>1</span>n, <span style=color:#c30>&#34;def&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>let</span> payload <span style=color:#555>=</span> zserialize(input, ZS.map(ZS.<span style=color:#078;font-weight:700>bigint</span>(BigIntFormat.Uint64), ZS.<span style=color:#078;font-weight:700>string</span>()))
</span></span><span style=display:flex><span><span style=color:#069;font-weight:700>let</span> output <span style=color:#555>=</span> zdeserialize(ZD.map(ZD.<span style=color:#078;font-weight:700>bigint</span>(BigIntFormat.Uint64), ZD.<span style=color:#078;font-weight:700>string</span>()), payload)
</span></span></code></pre></div><h2 id=example-chat-application>Example chat application</h2><p>An example browser application demonstrating the key parts of Zenoh Typescript API functionality was added. This is a multiuser chat application which sends/receives chat messages using <strong>pub/sub</strong> API, allows to restore chat history for new connected users using <strong>queryable/get</strong> API and shows list of online users using <strong>liveliness</strong> API.</p><p>See <a href="https://github.com/eclipse-zenoh/zenoh-ts?tab=readme-ov-file#build-and-run-examples">&ldquo;Build and run examples&rdquo;</a> section in the github readme for instructions how to run this example</p><h1 id=zenoh-java--zenoh-kotlin>Zenoh-Java / Zenoh-Kotlin</h1><h2 id=api-polish-and-alignments-1>API Polish and alignments</h2><p>For this release we have mostly worked on Zenoh-Java on aligning the API whose migration guide is now available on <a href=https://zenoh.io/docs/migration_1.0/java/>https://zenoh.io/docs/migration_1.0/java/</a>. We now provide the same features as on the other bindings.</p><p>Besides that, some changes on both projects include:</p><ul><li><p>Providing string overloads to functions requiring ZBytes instances, reducing the verbosity of the code when working with string messages.</p></li><li><p>Implementing the Querier feature</p></li><li><p>Fix missing QoS (quality of service) configuration options on session get operations.</p></li></ul><p>Regarding architectures, weâ€™ve now added support for the aarch64 architecture on Windows.</p><p>On both Zenoh-Kotlin and Zenoh-Java we have provided a further utility to run the examples, by allowing users to now build them as executable fat JARs.</p><h2 id=maven-publications>Maven Publications</h2><p>A big improvement was achieved with regards to the packages publication of these libraries which is that we are now publishing to Maven Central! Checkout</p><ul><li><p><a href=https://central.sonatype.com/artifact/org.eclipse.zenoh/zenoh-kotlin/overview>https://central.sonatype.com/artifact/org.eclipse.zenoh/zenoh-kotlin/overview</a></p></li><li><p><a href=https://central.sonatype.com/artifact/org.eclipse.zenoh/zenoh-kotlin-android/overview>https://central.sonatype.com/artifact/org.eclipse.zenoh/zenoh-kotlin-android/overview</a></p></li><li><p><a href=https://central.sonatype.com/artifact/org.eclipse.zenoh/zenoh-java/overview>https://central.sonatype.com/artifact/org.eclipse.zenoh/zenoh-java/overview</a></p></li><li><p><a href=https://central.sonatype.com/artifact/org.eclipse.zenoh/zenoh-java-android/overview>https://central.sonatype.com/artifact/org.eclipse.zenoh/zenoh-java-android/overview</a></p></li></ul><p>Now itâ€™s simpler to import the projects into your own projects by adding the MavenCentral repository and importing the appropriate library.</p><p>Thatâ€™s a wrap for Zenoh 1.3.3 â€” <strong>GozuryÅ«</strong>! This release brings significant improvements in performance, flexibility, and feature completeness across the stack. Whether you&rsquo;re building on constrained devices, working in highly dynamic environments, or scaling across complex networks, Zenoh now gives you more tools to do it right and while having fun ;-).</p><p>As always, weâ€™d love to hear your feedback, ideas, and contributions. Check out the <a href=https://github.com/eclipse-zenoh/zenoh>Zenoh repository</a>, join the conversation on <a href=https://discord.com/invite/vSDSpqnbkm>Zenohâ€™s Discord</a>, and let us know what you&rsquo;re building!</p><p>Until next time â€” stay fast, stay flexible, and keep streaming.</p><p><strong>â€“ The Zenoh Team</strong></p><div class=ato-next><b>Next up</b>: <a href=../../blog/2025-01-08-introducing-raspberry-pi-pico-support-in-zenoh-pico/>Introducing Raspberry Pi Pico Support in Zenoh-Pico</a></div></main></div></div><footer class="ato-footer text-muted"><div class="container-fluid p-6 p-md-5"><div class=row><div class=col-md-2><h5>Eclipse Incubation</h5><p><img src=../../img/eclipse-incubation.png style=width:100px></p><p>Eclipse zenoh &trade; is an incubating project under the Eclipse Foundation.</p></div><div class=col-md-2><h5>More Information</h5><p><a href=https://www.eclipse.org/legal target=_blank>Legal</a></p><p><a href=https://www.eclipse.org/legal/privacy.php target=_blank>Privacy policy</a></p><p><a href=https://www.eclipse.org/legal/termsofuse.php target=_blank>Terms of use</a></p><p><a href=https://www.eclipse.org/legal/copyright.php target=_blank>Copyright</a></p><p><a href=https://www.eclipse.org/security/ target=_blank>Report a security issue</a></p><p><a href=https://www.eclipse.org/legal/epl-2.0/ target=_blank>Eclipse Public License 2.0</a></p><p><a href=https://www.apache.org/licenses/LICENSE-2.0 target=_blank>Apache License 2.0</a></p><p><a href=https://www.eclipse.org/ target=_blank>Eclipse Foundation</a></p></div><div class=col-md-2><h5>Sponsored by:</h5><p><a href=https://www.eclipse.org target=_blank><img src=../../img/eclipse-foundation.svg style=width:120px></a></p><p><a href=https://zettascale.tech target=_blank><img src=../../img/zettascale-dark.svg style=width:120px></a></p></div><div class=col-md-2><h5>Follow us</h5><p><a href=https://github.com/eclipse-zenoh/zenoh><i class="fa fa-github" aria-hidden=true></i>
GitHub</a></p><p><a href=https://discord.gg/vSDSpqnbkm><i class="fa fa fa-comments-o" aria-hidden=true></i>
Discord</a></p><p><a href=https://www.youtube.com/channel/UCslbiyiqgOAPMjCrPWIfQ5Q><i class="fa fa-youtube-play" aria-hidden=true></i> Youtube</a></p><p><a href=../../docs/overview/what-is-zenoh><i class="fa fa-info-circle" aria-hidden=true></i> About</a></p></div><div class=col-md-2><p><img src=../../img/zenoh-dragon-150x163.png style=width:45px></p><p>Eclipse zenoh &trade; is free, open source and always will be.</p><p>Copyright &copy 2022 Eclipse Foundation</p><p>Built with <a href=https://gohugo.io/ target=_blank>HUGO</a></p></div></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js integrity=sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7 crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js integrity=sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8 crossorigin=anonymous></script>
<script src=../../js/bootstrap.min.js></script>
<script src=../../js/highlight.min.js></script>
<script>$(function(){$("pre code").each(function(e,t){if(t.className.indexOf("language-rust")>=0){for(var s="",n=t.textContent.split(`
`),e=0;e<n.length;e++){if(n[e].indexOf("# ")==0||n[e]=="#")continue;s+=n[e].trimRight()+`
`}t.textContent=s.replace(/\n\n\n/g,`

`).trimRight()}hljs.highlightBlock(t)})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PBD6MS51QL"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PBD6MS51QL",{anonymize_ip:!1})}</script></body></html>