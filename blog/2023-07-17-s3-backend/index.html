<!doctype html><html lang=en><head><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.png><meta name=msapplication-TileImage content="/safari-pinned-tab.png"><meta name=msapplication-TileColor content="#7da7d8"><meta name=theme-color content="#7da7d8"><meta charset=utf-8><meta name=description content="Eclipse Zenoh, unify data in motion, data at rest and computations."><meta name=keywords content="pub/sub,query,geo distributed storage,Rust,protocol,DDS,MQTT,Edge,IoT,MEC"><meta name=author content="The Zenoh Team"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=../../css/bootstrap-reboot.css><link rel=stylesheet href=../../css/bootstrap.css><link rel=stylesheet href=../../css/font-awesome.min.css><link rel=stylesheet href=../../css/ato.css><link rel=stylesheet href=../../css/syntax.css><link rel=alternate type=application/rss+xml href=../../blog/index.xml><title>Zenoh Storage Gets a Boost: Empowering Storage with S3 Integration · Zenoh - pub/sub, geo distributed storage, query</title></head><body><header class="navbar-expand navbar-dark d-flex flex-column flex-md-row align-items-md-center ato-navbar"><div class="d-flex flex-row justify-content-between pl-2 pr-2"><a class=navbar-brand href=../../><img src=../../img/zenoh-dragon-bg-150x163.png class=align-middle alt></a>
<button class="btn btn-link d-md-none p-0" type=button data-toggle=collapse data-target=#ato-nav aria-controls=ato-nav aria-expanded=false aria-label="Toggle navigation"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/></svg></button></div><div class="ato-links collapse pl-4 pl-md-0" id=ato-nav><ul class="navbar-nav flex-column flex-md-row"><li class=nav-item><a class=nav-link href=../../>Home</a></li><li class=nav-item><a class=nav-link href=../../docs/getting-started/first-app/>Documentation</a></li><li class=nav-item><a class=nav-link href=../../usecases/>Use Cases</a></li><li class=nav-item><a class=nav-link href=../../community/>Community</a></li><li class=nav-item><a class=nav-link href=../../adopters/>Adopters</a></li><li class=nav-item><a class=nav-link href=../../media/>Media</a></li><li class=nav-item><a class="nav-link active" href=../../blog/2025-04-09-zenoh-pico-performance/>Blog</a></li></ul></div><ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex"><li class=nav-item><a class="nav-link p-2" href=https://github.com/eclipse-zenoh/zenoh target=_blank rel=noopener aria-label=GitHub><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false"><title>GitHub</title><path d="M256 0C114.64.0.0 114.61.0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34.0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49.0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75.0.0 21.49-6.88 70.4 26.24a242.65 242.65.0 01128.18.0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69.0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41.0 34.22-.31 61.83-.31 70.23.0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37.0 256 0z" fill="currentcolor" fill-rule="evenodd"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://twitter.com/zettascaletech target=_blank rel=noopener aria-label=Twitter><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false"><title>Twitter</title><path d="M160.83 416.32c193.2.0 298.92-160.22 298.92-298.92.0-4.51.0-9-.2-13.52A214 214 0 00512 49.38a212.93 212.93.0 01-60.44 16.6 105.7 105.7.0 0046.3-58.19 209 209 0 01-66.79 25.37 105.09 105.09.0 00-181.73 71.91 116.12 116.12.0 002.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48.0 0068 159.6a106.27 106.27.0 01-47.53-13.11v1.43a105.28 105.28.0 0084.21 103.06 105.67 105.67.0 01-47.33 1.84 105.06 105.06.0 0098.14 72.94A210.72 210.72.0 0125 370.84a202.17 202.17.0 01-25-1.43 298.85 298.85.0 00160.83 46.92" fill="currentcolor"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://discord.gg/2GJ958VuHs target=_blank rel=noopener aria-label=Discord><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" focusable="false"><title>Discord</title><path fill="currentcolor" d="M13.545 2.907a13.227 13.227.0 00-3.257-1.011.05.05.0 00-.052.025c-.141.25-.297.577-.406.833a12.19 12.19.0 00-3.658.0 8.258 8.258.0 00-.412-.833.051.051.0 00-.052-.025c-1.125.194-2.22.534-3.257 1.011a.041.041.0 00-.021.018C.356 6.024-.213 9.047.066 12.032c.001.014.01.028.021.037a13.276 13.276.0 003.995 2.02.05.05.0 00.056-.019c.308-.42.582-.863.818-1.329a.05.05.0 00-.01-.059.051.051.0 00-.018-.011 8.875 8.875.0 01-1.248-.595.05.05.0 01-.02-.066.051.051.0 01.015-.019c.084-.063.168-.129.248-.195a.05.05.0 01.051-.007c2.619 1.196 5.454 1.196 8.041.0a.052.052.0 01.053.007c.08.066.164.132.248.195a.051.051.0 01-.004.085 8.254 8.254.0 01-1.249.594.05.05.0 00-.03.03.052.052.0 00.003.041c.24.465.515.909.817 1.329a.05.05.0 00.056.019 13.235 13.235.0 004.001-2.02.049.049.0 00.021-.037c.334-3.451-.559-6.449-2.366-9.106a.034.034.0 00-.02-.019zm-8.198 7.307c-.789.0-1.438-.724-1.438-1.612.0-.889.637-1.613 1.438-1.613.807.0 1.45.73 1.438 1.613.0.888-.637 1.612-1.438 1.612zm5.316.0c-.788.0-1.438-.724-1.438-1.612.0-.889.637-1.613 1.438-1.613.807.0 1.451.73 1.438 1.613.0.888-.631 1.612-1.438 1.612z"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://www.youtube.com/channel/UCslbiyiqgOAPMjCrPWIfQ5Q target=_blank rel=noopener aria-label=Youtube><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" focusable="false"><title>Youtube</title><path fill="currentcolor" d="M8.051 1.999h.089c.822.003 4.987.033 6.11.335a2.01 2.01.0 011.415 1.42c.101.38.172.883.22 1.402l.01.104.022.26.008.104c.065.914.073 1.77.074 1.957v.075c-.001.194-.01 1.108-.082 2.06l-.008.105-.009.104c-.05.572-.124 1.14-.235 1.558a2.007 2.007.0 01-1.415 1.42c-1.16.312-5.569.334-6.18.335h-.142c-.309.0-1.587-.006-2.927-.052l-.17-.006-.087-.004-.171-.007-.171-.007c-1.11-.049-2.167-.128-2.654-.26a2.007 2.007.0 01-1.415-1.419c-.111-.417-.185-.986-.235-1.558L.09 9.82.082 9.716A31.4 31.4.0 010 7.68v-.123c.002-.215.01-.958.064-1.778l.007-.103.003-.052.008-.104.022-.26.01-.104c.048-.519.119-1.023.22-1.402a2.007 2.007.0 011.415-1.42c.487-.13 1.544-.21 2.654-.26l.17-.007.172-.006.086-.003.171-.007A99.788 99.788.0 017.858 2h.193zM6.4 5.209v4.818l4.157-2.408L6.4 5.209z"/></svg></a></li></ul><script async src="https://www.googletagmanager.com/gtag/js?id=G-PBD6MS51QL"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PBD6MS51QL")</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":""},"articleSection":"blog","name":"Zenoh Storage Gets a Boost: Empowering Storage with S3 Integration","headline":"Zenoh Storage Gets a Boost: Empowering Storage with S3 Integration","datePublished":"2023-07-17 00:00:00 \u002b0000 UTC","dateModified":"2023-07-17 00:00:00 \u002b0000 UTC","url":"\/blog\/2023-07-17-s3-backend\/","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"171717","wordCount":"1932","keywords":[],"description":"July 17th, 2023 -- Paris"}</script></header><div class="container-fluid ato-blog"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 ato-sidebar"><div class="ato-docs-toggle d-md-none p-0 d-flex ml-3 collapsed align-item-center"><h1 class=ato-title>Zenoh Storage Gets a Boost: Empowering Storage with S3 Integration</h1><button class="btn btn-link" type=button data-toggle=collapse data-target=#ato-docs-nav aria-controls=ato-docs-nav aria-expanded=false aria-label="Toggle docs navigation"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/></svg></button></div><nav class="ato-links collapse" id=ato-docs-nav><div class="ato-toc-item active"><p class=ato-toc-link>Blog Posts</p><ul class="nav ato-sidenav"><li><a href=../../blog/2025-04-09-zenoh-pico-performance/>Zenoh-Pico performance improvements</a></li><li><a href=../../blog/2025-04-14-zenoh-gozuryu/>Zenoh Gozuryū is Here!</a></li><li><a href=../../blog/2025-01-08-introducing-raspberry-pi-pico-support-in-zenoh-pico/>Introducing Raspberry Pi Pico Support in Zenoh-Pico</a></li><li><a href=../../blog/2024-12-12-zenoh-firesong-1.1.0/>Zenoh 1.1.0: Firesong Keeps Rocking 🎸</a></li><li><a href=../../blog/2024-10-21-zenoh-firesong/>Zenoh 1.0.0 "Firesong" is ready to rock!</a></li><li><a href=../../blog/2024-04-30-zenoh-electrode/>Zenoh 0.11.0 "Electrode" release is out!</a></li><li><a href=../../blog/2024-04-17-datadog-zenoh-router-integration/>Streamlining Zenoh router Monitoring with Datadog Integration</a></li><li><a href=../../blog/2024-01-31-zenoh-flow-getting-started/>Zenoh-Flow 0.6.0-rc: Getting Started</a></li><li><a href=../../blog/2023-10-03-zenoh-dragonite/>Zenoh Dragonite Took Off!</a></li><li><a href=../../blog/2023-07-17-s3-backend/>Zenoh Storage Gets a Boost: Empowering Storage with S3 Integration</a></li><li><a href=../../blog/2023-06-05-charmander2/>Zenoh Charmander Grows Stronger</a></li><li><a href=../../blog/2023-04-04-letsencrypt/>Securing Zenoh with LetsEncrypt: A Comprehensive Guide</a></li><li><a href=../../blog/2023-03-21-zenoh-vs-mqtt-kafka-dds/>Comparing the Performance of Zenoh, MQTT, Kafka, and DDS</a></li><li><a href=../../blog/2023-02-10-zenoh-flow/>Data Flow programming with Zenoh-Flow</a></li><li><a href=../../blog/2023-01-17-zenoh-wireshark/>The Blue Dragon meets the Wire’s Shark</a></li><li><a href=../../blog/2023-01-10-zenoh-charmander/>Zenoh Charmander is coming to town</a></li><li><a href=../../blog/2022-11-29-zenoh-alignment/>Keeping storages aligned in Zenoh</a></li><li><a href=../../blog/2022-09-30-zenoh-bahamut/>Zenoh Bahamut takes flight!</a></li><li><a href=../../blog/2022-08-12-zenoh-serial/>There is Land Besides IP: How to Cross It with Zenoh</a></li><li><a href=../../blog/2022-06-09-zenoh-pico-above-and-beyond/>Zenoh-Pico: Above and Beyond</a></li><li><a href=../../blog/2022-04-14-rust-async-eval/>A Performance Evaluation on Rust Asynchronous Frameworks</a></li><li><a href=../../blog/2022-03-30-zenoh-mobility/>Mobility, Latency and Energy saving</a></li><li><a href=../../blog/2022-02-08-dragonbot/>DragonBotOne Egg Hatching with Zenoh and Zenoh-Pico</a></li><li><a href=../../blog/2021-11-09-ros2-zenoh-pico/>ROS 2 and microcontrollers integration via Zenoh-pico</a></li><li><a href=../../blog/2021-10-04-zenoh-pico-guide/>Zenoh goes embedded with zenoh-pico</a></li><li><a href=../../blog/2021-09-28-iac-experiences-from-the-trenches/>Indy Autonomous Challenge (IAC): Experiences from the Trenches</a></li><li><a href=../../blog/2021-07-13-zenoh-performance-async/>Zenoh performance: a stroll in Rust async wonderland</a></li><li><a href=../../blog/2021-07-05-zenoh-overhead/>Zenoh overhead: a story from our community</a></li><li><a href=../../blog/2021-06-14-zenoh-reliability/>Zenoh Reliability, Scalability and Congestion Control</a></li><li><a href=../../blog/2021-04-28-ros2-integration/>Integrating ROS2 with Eclipse zenoh</a></li><li><a href=../../blog/2021-03-23-discovery/>Minimizing Discovery Overhead in ROS2</a></li><li><a href=../../blog/2020-10-08-aithusa/>Zenoh Aithusa Hatched Out!</a></li><li><a href=../../blog/2020-06-29-zenoh-tidings/>Zenoh Tidings</a></li><li><a href=../../blog/2020-01-01-zenohtude/>A Year Full of Zenoh</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 ato-toc"><div class=section-nav><nav id=TableOfContents><ul><li><ul><li><a href=#contents>Contents</a></li></ul></li><li><a href=#zenoh-backends>Zenoh Backends</a></li><li><a href=#features>Features</a><ul><li><a href=#s3-storage>S3 storage</a></li><li><a href=#compatibility-with-minio>Compatibility with MinIO</a></li><li><a href=#tls-support>TLS support</a></li></ul></li><li><a href=#configuration>Configuration</a></li><li><a href=#considerations>Considerations</a><ul><li><a href=#same-name-files-and-directories>Same name files and directories</a></li><li><a href=#sample-timestamps>Sample timestamps</a></li><li><a href=#replicas-support>Replicas support</a></li><li><a href=#aws-sdk-s3-library>Aws-sdk-s3 library</a></li></ul></li></ul></nav></div></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 ato-content ato-docs"><h1 class=ato-title>Zenoh Storage Gets a Boost: Empowering Storage with S3 Integration</h1><p class=ato-date>July 17th, 2023 -- Paris</p><p>As we happily announced on the blog post for the Zenoh 0.7.0-rc release (<a href=https://zenoh.io/blog/2023-01-10-zenoh-charmander/>Zenoh Charmander is coming to town</a>), we now provide enhanced backend storage capabilities with the new AmazonS3/MinIO backend implementation.</p><p>This was a requested feature that originated within <a href=https://discord.gg/2GJ958VuHs>our community on Discord</a> which soon made its way into the <a href=https://github.com/eclipse-zenoh/roadmap>roadmap</a>.</p><p>The S3 backend can be installed by downloading the package from ​​<a href=https://download.eclipse.org/zenoh/zenoh-backend-s3/latest/>https://download.eclipse.org/zenoh/zenoh-backend-s3/latest/</a>. The source code can be found in our eclipse-zenoh repository: <a href=https://github.com/eclipse-zenoh/zenoh-backend-s3>https://github.com/eclipse-zenoh/zenoh-backend-s3</a>. Inside you will find a README with detailed instructions on how to set up this backend for both Amazon S3 and MinIO.</p><h3 id=contents>Contents</h3><p>In this blog post we&rsquo;ll go through the S3 backend, explaining what&rsquo;s the conception behind a backend, how the S3 backend fits into it, how to configure it and what are some of its limits and considerations to take when using this backend.</p><p><strong>Table of contents:</strong></p><ol><li><a href=#zenoh-backends>Zenoh Backends</a></li><li><a href=#features>Features</a></li><li><a href=#configuration>Configuration</a></li><li><a href=#considerations>Considerations</a></li></ol><hr><h2 id=zenoh-backends>Zenoh Backends</h2><p>You may ask yourself “what is a backend?”. Well, in Zenoh a backend is a storage technology allowing to store the key/values publications made via Zenoh and return them on queries. Different storage technologies allow storing key/values based on different use cases.</p><p>At the moment we had three backend systems:</p><ul><li><a href=https://www.influxdata.com/>InfluxDB</a>: a time series data platform userful for developers to build IoT, analytics and cloud applications<ul><li>Repository: <a href=https://github.com/eclipse-zenoh/zenoh-backend-influxdb>https://github.com/eclipse-zenoh/zenoh-backend-influxdb</a></li></ul></li><li><a href=http://rocksdb.org/>RocksDB</a>: a high-performance persistent key-value store for fast storage environments<ul><li>Repository: <a href=https://github.com/eclipse-zenoh/zenoh-backend-rocksdb>https://github.com/eclipse-zenoh/zenoh-backend-rocksdb</a></li></ul></li><li>FileSystem: this backend relies on the host&rsquo;s file system to implement the storages.<ul><li>Repository: <a href=https://github.com/eclipse-zenoh/zenoh-backend-filesystem>https://github.com/eclipse-zenoh/zenoh-backend-filesystem</a></li></ul></li></ul><p>AmazonS3 joins this list with the capability of storing the data on a cloud storage service.</p><p>It will boost our storage capabilities, especially when it comes to object oriented storage. So far the only way to work with object storages was using the FileSystem backend which was designed to be a simple storage option constrained into the host’s filesystem. It is a backend that also lacks many of the mechanisms a cloud storage provides regarding security, data availability and performance, and is not very scalable either.</p><p>Our users needed the possibility to interact with an object storage technology that could easily be set up on the cloud, that would already provide performance, security and data availability and that could be scalable. Amazon S3 reunited all of these conditions and was immediately proposed, as up to today it’s been a proven technology with a broad adoption in the systems industry.</p><h2 id=features>Features</h2><h3 id=s3-storage>S3 storage</h3><p><a href=https://aws.amazon.com/s3/>Amazon S3</a> (which stands for Simple Storage Service) provides object storage capabilities through Amazon Web Services, offering “industry-leading scalability, data availability, security, and performance”.</p><p>This backend allows us to:</p><ul><li>store values as files/objects in an S3 bucket</li><li>create a bucket</li><li>reuse an existing bucket</li><li>put values on the storage, that is to create or update a file in the storage with the value specified, under the path provided by the key expression</li><li>query values / files with:<ul><li>concrete key expressions</li><li>key expressions containing wild cards (‘<code>\*</code>’ and ‘<code>\*\*</code>’) (which will return the values of the files whose path match the key expression)</li></ul></li><li>delete files</li><li>delete the storage</li></ul><figure class=figure-inline><img src=../../img/20220922-blog-zenoh-charmander/s3.png alt="S3 storage backend" width=60% height=auto></figure><h3 id=compatibility-with-minio>Compatibility with MinIO</h3><p><a href=http://min.io>MinIO</a> is an open source multi-cloud object storage that offers high-performance and is an S3 compatible object storage. We developed the backend in order for you to be able to either choose AmazonS3 or MinIO depending on your use cases. There may be many factors for you to decide on one over the other. One to consider is the amount of interactions with the storage, as with Zenoh, you can receive thousands of requests to put or retrieve data from a storage, which can have an impact on the pricing of your storage in case of using Amazon S3.</p><h3 id=tls-support>TLS support</h3><p>AmazonS3 provides HTTPS support per se, but if you set up your own S3 instances using MinIO, you’ll probably want to secure the connection using TLS. For that you need to specify the certificates that will allow you to authenticate your servers. That certificate from the certificate authority can be specified in the configuration file.</p><h2 id=configuration>Configuration</h2><p>The example configuration file below can also be found in <a href=https://github.com/eclipse-zenoh/zenoh-backend-s3/blob/main/zenoh.json5>our repository</a>. In it we have parameters for ‘volumes’ and ‘storages’.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#309;font-weight:700>&#34;plugins&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#309;font-weight:700>&#34;storage_manager&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#309;font-weight:700>&#34;volumes&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#309;font-weight:700>&#34;s3&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#09f;font-style:italic>// This field is mandatory if you are going to communicate with an AWS S3 server and
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#09f;font-style:italic>// optional in case you are working with a MinIO S3 server.
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#309;font-weight:700>&#34;region&#34;</span>: <span style=color:#c30>&#34;eu-west-1&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#09f;font-style:italic>// Endpoint where the S3 server is located.
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#09f;font-style:italic>// This parameter allows you to specify a custom endpoint when working with a MinIO S3
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#09f;font-style:italic>// server.
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#09f;font-style:italic>// This field is mandatory if you are working with a MinIO server and optional in case
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#09f;font-style:italic>// you are working with an AWS S3 server as long as you specified the region, in which
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#09f;font-style:italic>// case the endpoint will be resolved automatically.
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#309;font-weight:700>&#34;url&#34;</span>: <span style=color:#c30>&#34;https://s3.eu-west-1.amazonaws.com&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#09f;font-style:italic>// Optional TLS specific parameters to enable HTTPS with MinIO. Configuration shared by
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#09f;font-style:italic>// all the associated storages.
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#309;font-weight:700>&#34;tls&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic>// Certificate authority to authenticate the server.
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>            <span style=color:#309;font-weight:700>&#34;root_ca_certificate&#34;</span>: <span style=color:#c30>&#34;./certificates/minio/ca.pem&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#309;font-weight:700>&#34;storages&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#09f;font-style:italic>// Configuration of a &#34;demo&#34; storage using the S3 volume. Each storage is associated to a
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>        <span style=color:#09f;font-style:italic>// single S3 bucket.
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>        <span style=color:#309;font-weight:700>&#34;s3_storage&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#09f;font-style:italic>// The key expression this storage will subscribes to
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#309;font-weight:700>&#34;key_expr&#34;</span>: <span style=color:#c30>&#34;s3/example/*&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#09f;font-style:italic>// this prefix will be stripped from the received key when converting to database key.
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#09f;font-style:italic>// i.e.: &#34;demo/example/a/b&#34; will be stored as &#34;a/b&#34;
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>          <span style=color:#309;font-weight:700>&#34;strip_prefix&#34;</span>: <span style=color:#c30>&#34;s3/example&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#309;font-weight:700>&#34;volume&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic>// Id of the volume this storage is associated to
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>            <span style=color:#309;font-weight:700>&#34;id&#34;</span>: <span style=color:#c30>&#34;s3&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic>// Bucket to which this storage is associated to
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>            <span style=color:#309;font-weight:700>&#34;bucket&#34;</span>: <span style=color:#c30>&#34;zenoh-bucket&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic>// The storage attempts to create the bucket, but if the bucket already exists and is
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>            <span style=color:#09f;font-style:italic>// owned by you, then with &#39;reuse_bucket&#39; you can associate that preexisting bucket to
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>            <span style=color:#09f;font-style:italic>// the storage, otherwise it will fail.
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>            <span style=color:#309;font-weight:700>&#34;reuse_bucket&#34;</span>: <span style=color:#069;font-weight:700>true</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic>// If the storage is read only, it will only handle GET requests
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>            <span style=color:#309;font-weight:700>&#34;read_only&#34;</span>: <span style=color:#069;font-weight:700>false</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#09f;font-style:italic>// strategy on storage closure, either `destroy_bucket` or `do_nothing`
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>            <span style=color:#309;font-weight:700>&#34;on_closure&#34;</span>: <span style=color:#c30>&#34;destroy_bucket&#34;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#309;font-weight:700>&#34;private&#34;</span>: {
</span></span><span style=display:flex><span>              <span style=color:#09f;font-style:italic>// Credentials for interacting with the S3 bucket
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>              <span style=color:#309;font-weight:700>&#34;access_key&#34;</span>: <span style=color:#c30>&#34;AKIAIOSFODNN7EXAMPLE&#34;</span>,
</span></span><span style=display:flex><span>              <span style=color:#309;font-weight:700>&#34;secret_key&#34;</span>: <span style=color:#c30>&#34;wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#09f;font-style:italic>// Optionally, add the REST plugin
</span></span></span><span style=display:flex><span><span style=color:#09f;font-style:italic></span>    <span style=color:#309;font-weight:700>&#34;rest&#34;</span>: { <span style=color:#309;font-weight:700>&#34;http_port&#34;</span>: <span style=color:#f60>8000</span> }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In our conception of what an S3 storage is, each storage is associated with an S3 bucket, while a volume is associated with a server. A volume can be associated with many storages, which means that all the s3 buckets are going to be stored on the same server.</p><p>The volume configuration required is limited to specifying where the server is going to be located (if you are using Amazon S3 you need to specify only the region, while when using MinIO you need to provide an url) and eventually the TLS certificate path. All the storages associated with it will share the same configuration.</p><p>Within the storage configuration, we specify the key expression, the name of the bucket, the credentials needed to access it, some policies related to the creation of the storage and its read-write permissions, etc… More detail is provided in the example config file.</p><h2 id=considerations>Considerations</h2><p>Keep in mind that this S3 backend is still a work in progress and some extra work on it is to be expected.</p><p>There are a couple things to consider when using this backend at this stage, some related to how MinIO and AmazonS3 work and some related to the status of the development of this backend.</p><h3 id=same-name-files-and-directories>Same name files and directories</h3><p>Regarding the differences between MinIO and AmazonS3, MinIO is “S3 compatible”, which doesn’t mean it works identically.</p><p>One difference we noted during the development emerged from the question: what if we put a value under the key ‘a/b’ and later another one under <code>a/b/c</code>. With Zenoh one may expect this to be possible; Zenoh allows you to publish a value under <code>a/b/c</code> or under <code>a/b</code>, receivers subscribed to <code>a/\*\*</code> for instance should be able to receive both events, independently if the listener is a storage or not.</p><p>So how does the system behave when dealing with this situation?</p><pre tabindex=0><code>└── a
    ├── b
    │   └── c
    └── b
</code></pre><p>Performing a publication under <code>a/b</code> and later under <code>a/b/c</code> (or inversely) means we’ll have a directory with the same name as a file under the same location, under <code>/a</code>!<br>MinIO doesn’t permit such a behavior and will throw an error message when attempting to perform such a thing. However, Amazon S3 doesn’t complain at all! That is because Amazon S3 uses a flat namespace to organize its files and directories, while MinIO uses the file system hierarchy for storing (see <a href=https://github.com/minio/minio/issues/7335>this discussion</a> for more info). With file systems we can not have a file with the same name as a directory at the same place. We had in fact stumbled with this issue when developing the file system backend some time ago, and had to develop a mechanism to allow this behavior and store the values for both events. However on this new S3 backend, a mechanism for this is not implemented for the moment, so you need to keep that into consideration when using this backend alongside MinIO at this stage.</p><h3 id=sample-timestamps>Sample timestamps</h3><p>We are not yet taking into consideration the timestamps of the samples, this may cause problems in some edge cases, for instance in the case we send a PUT immediately followed by a DELETE on the same key expression, it may happen that the DELETE operation gets to the storage earlier than the PUT, which would cause a file to be kept stored instead of being removed as intended, due to order issues. Taking the timestamps into account would have allowed us in this example case to discard the PUT operation, avoiding to corrupt the storage. This is yet to be implemented and an <a href=https://github.com/eclipse-zenoh/zenoh-backend-s3/issues/5>issue</a> is already opened for it.</p><h3 id=replicas-support>Replicas support</h3><p>Replication is not yet supported from the Zenoh side. If we have two S3 backends subscribed to the same key expression and one goes momentarily down, when respawning it needs to fetch the data it missed from the other backend to synchronize. This is not yet implemented. We can, however, profit from the replication mechanisms both Amazon S3 and MinIO provide.</p><p>Another replication problem comes in when we want to have multiple but with different backends, for instance S3 and RocksDB. There is no workaround for this at the moment and it’s up to the user to manually take care of synchronization.</p><h3 id=aws-sdk-s3-library>Aws-sdk-s3 library</h3><p>Finally, this implementation relies on Amazon’s <a href=https://crates.io/crates/aws-sdk-s3>aws-sdk-s3 Rust crate</a>, which is itself under development and clearly states: “<em>Please Note: The SDK is currently in Developer Preview and is intended strictly for feedback purposes only. Do not use this SDK for production workloads.</em>” So, you need to take that into strong consideration before making a production release.</p><p>As of today, the amazon’s engineering team that’s developing this crate is regularly publishing new versions of it. As a consequence, new versions of this backend are to be expected in the future in order to update the dependency versions.</p><h1 id=whats-next>What&rsquo;s next!</h1><p>This concludes our post on how to use S3 as a storage for Zenoh thanks to our recent implementation of the S3 backend.</p><p>Although it’s a work in progress, this first version of it already provides us with many functionalities. We can:</p><ul><li>take advantage of Zenoh’s virtues such as using key expressions for querying data from S3 storages</li><li>secure our communications with the S3 storages with TLS</li><li>use MinIO as an alternative to Amazon S3</li></ul><p>There are nevertheless limitations we aim to tackle in the near future.</p><p>Stay tuned for updates and don’t forget to stay in touch with the Zenoh team on <a href=https://discord.gg/vSDSpqnbkm>Discord</a> and to propose new features on the <a href=https://github.com/eclipse-zenoh/roadmap/discussions>roadmap</a>.</p><p><img src=../../img/20220930-blog-zenoh-bahamut/zenoh-on-fire.gif alt="Zenoh rocks"></p><p><a href=https://github.com/orgs/eclipse-zenoh/people>–The Zenoh Team</a></p><div class=ato-next><b>Next up</b>: <a href=../../blog/2023-06-05-charmander2/>Zenoh Charmander Grows Stronger</a></div></main></div></div><footer class="ato-footer text-muted"><div class="container-fluid p-6 p-md-5"><div class=row><div class=col-md-2><h5>Eclipse Incubation</h5><p><img src=../../img/eclipse-incubation.png style=width:100px></p><p>Eclipse zenoh &trade; is an incubating project under the Eclipse Foundation.</p></div><div class=col-md-2><h5>More Information</h5><p><a href=https://www.eclipse.org/legal target=_blank>Legal</a></p><p><a href=https://www.eclipse.org/legal/privacy.php target=_blank>Privacy policy</a></p><p><a href=https://www.eclipse.org/legal/termsofuse.php target=_blank>Terms of use</a></p><p><a href=https://www.eclipse.org/legal/copyright.php target=_blank>Copyright</a></p><p><a href=https://www.eclipse.org/security/ target=_blank>Report a security issue</a></p><p><a href=https://www.eclipse.org/legal/epl-2.0/ target=_blank>Eclipse Public License 2.0</a></p><p><a href=https://www.apache.org/licenses/LICENSE-2.0 target=_blank>Apache License 2.0</a></p><p><a href=https://www.eclipse.org/ target=_blank>Eclipse Foundation</a></p></div><div class=col-md-2><h5>Sponsored by:</h5><p><a href=https://www.eclipse.org target=_blank><img src=../../img/eclipse-foundation.svg style=width:120px></a></p><p><a href=https://zettascale.tech target=_blank><img src=../../img/zettascale-dark.svg style=width:120px></a></p></div><div class=col-md-2><h5>Follow us</h5><p><a href=https://github.com/eclipse-zenoh/zenoh><i class="fa fa-github" aria-hidden=true></i>
GitHub</a></p><p><a href=https://discord.gg/vSDSpqnbkm><i class="fa fa fa-comments-o" aria-hidden=true></i>
Discord</a></p><p><a href=https://www.youtube.com/channel/UCslbiyiqgOAPMjCrPWIfQ5Q><i class="fa fa-youtube-play" aria-hidden=true></i> Youtube</a></p><p><a href=../../docs/overview/what-is-zenoh><i class="fa fa-info-circle" aria-hidden=true></i> About</a></p></div><div class=col-md-2><p><img src=../../img/zenoh-dragon-150x163.png style=width:45px></p><p>Eclipse zenoh &trade; is free, open source and always will be.</p><p>Copyright &copy 2022 Eclipse Foundation</p><p>Built with <a href=https://gohugo.io/ target=_blank>HUGO</a></p></div></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js integrity=sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7 crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js integrity=sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8 crossorigin=anonymous></script>
<script src=../../js/bootstrap.min.js></script>
<script src=../../js/highlight.min.js></script>
<script>$(function(){$("pre code").each(function(e,t){if(t.className.indexOf("language-rust")>=0){for(var s="",n=t.textContent.split(`
`),e=0;e<n.length;e++){if(n[e].indexOf("# ")==0||n[e]=="#")continue;s+=n[e].trimRight()+`
`}t.textContent=s.replace(/\n\n\n/g,`

`).trimRight()}hljs.highlightBlock(t)})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PBD6MS51QL"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PBD6MS51QL",{anonymize_ip:!1})}</script></body></html>