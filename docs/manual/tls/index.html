<!doctype html><html lang=en><head><link rel=apple-touch-icon sizes=180x180 href=../../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../../favicon-16x16.png><link rel=manifest href=../../../site.webmanifest><link rel=mask-icon href=../../../safari-pinned-tab.png color=#7da7d8><meta name=msapplication-TileColor content="#7da7d8"><meta name=theme-color content="#7da7d8"><meta charset=utf-8><meta name=description content="Eclipse Zenoh, unify data in motion, data at rest and computations."><meta name=keywords content="pub/sub,query,geo distributed storage,Rust,protocol,DDS,MQTT,Edge,IoT,MEC"><meta name=author content="The Zenoh Team"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=../../../css/bootstrap-reboot.css><link rel=stylesheet href=../../../css/bootstrap.css><link rel=stylesheet href=../../../css/font-awesome.min.css><link rel=stylesheet href=../../../css/ato.css><link rel=stylesheet href=../../../css/syntax.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css><link rel=alternate type=application/rss+xml href=../../../blog/index.xml><title>TLS authentication Â· zenoh - pub/sub, geo distributed storage, query</title></head><body><header class="navbar navbar-expand navbar-dark flex-column flex-md-row ato-navbar"><a class=navbar-brand href=../../../><img src=../../../img/zenoh-dragon-bg.png class=align-middle alt></a><div class="collapse navbar-collapse"><ul class=navbar-nav><li class=nav-item><a class=nav-link href=../../../>Home</a></li><li class=nav-item><a class="nav-link active" href=../../../docs/getting-started/quick-test/>Documentation</a></li><li class=nav-item><a class=nav-link href=../../../community/>Community</a></li><li class=nav-item><a class=nav-link href=../../../blog/2021-03-23-discovery/>Blog</a></li></ul></div><ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex"><li class=nav-item><a class="nav-link p-2" href=https://github.com/eclipse-zenoh/zenoh target=_blank rel=noopener aria-label=GitHub><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false"><title>GitHub</title><path d="M256 0C114.64.0.0 114.61.0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34.0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49.0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75.0.0 21.49-6.88 70.4 26.24a242.65 242.65.0 01128.18.0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69.0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41.0 34.22-.31 61.83-.31 70.23.0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37.0 256 0z" fill="currentcolor" fill-rule="evenodd"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://twitter.com/atolab_ target=_blank rel=noopener aria-label=Twitter><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 416.32" focusable="false"><title>Twitter</title><path d="M160.83 416.32c193.2.0 298.92-160.22 298.92-298.92.0-4.51.0-9-.2-13.52A214 214 0 00512 49.38a212.93 212.93.0 01-60.44 16.6 105.7 105.7.0 0046.3-58.19 209 209 0 01-66.79 25.37 105.09 105.09.0 00-181.73 71.91 116.12 116.12.0 002.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48.0 0068 159.6a106.27 106.27.0 01-47.53-13.11v1.43a105.28 105.28.0 0084.21 103.06 105.67 105.67.0 01-47.33 1.84 105.06 105.06.0 0098.14 72.94A210.72 210.72.0 0125 370.84a202.17 202.17.0 01-25-1.43 298.85 298.85.0 00160.83 46.92" fill="currentcolor"/></svg></a></li><li class=nav-item><a class="nav-link p-2" href=https://gitter.im/atolab/zenoh target=_blank rel=noopener aria-label=Gitter><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" focusable="false"><title>Gitter</title><path fill="currentcolor" d="M8.501 4.001H10.5V24H8.501V4.001zm6.999.0V24h-2V4.001h2zM3.5.0h2.001v15H3.5V0zm15 4.001h2V15h-2V4.001z"/></svg></a></li></ul><script async src="https://www.googletagmanager.com/gtag/js?id=UA-120904581-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-41082619-2');</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":""},"articleSection":"docs","name":"TLS authentication","headline":"TLS authentication","datePublished":"0001-01-01 00:00:00 \x2b0000 UTC","dateModified":"0001-01-01 00:00:00 \x2b0000 UTC","url":"\/docs\/manual\/tls\/","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"1011","wordCount":"590","keywords":[],"description":"Zenoh supports TLS as a transport protocol. As of today, the only supported TLS authentication mode is server-authentication: clients validate the server TLS certificate but not the other way around. That is, the same way of operating in the web where the web browsers validate the identity of the server via means of the TLS certificate.\n TLS certificates creation In order to use TLS as a transport protocol, we need first to create the TLS certificates."}</script></header><div class="container-fluid ato-docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 ato-sidebar"><form class="ato-search d-flex align-items-center"><span class="algolia-autocomplete algolia-autocomplete-left" style=position:relative;display:inline-block;direction:ltr><input class="form-control ds-input" id=search-input placeholder=Search... autocomplete=off spellcheck=false role=combobox aria-autocomplete=list aria-expanded=false aria-owns=algolia-autocomplete-listbox-0 style=position:relative;vertical-align:top dir=auto type=search><pre aria-hidden=true style="position:absolute;visibility:hidden;white-space:pre;font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol;font-size:16px;font-style:normal;font-variant:normal;font-weight:400;word-spacing:0;letter-spacing:normal;text-indent:0;text-rendering:optimizelegibility;text-transform:none">w</pre><span class="ds-dropdown-menu ds-with-1" style=position:absolute;top:100%;left:0;z-index:100;right:auto;display:none role=listbox id=algolia-autocomplete-listbox-0><div class=ds-dataset-1></div></span></span><button class="btn btn-link ato-search-docs-toggle d-md-none p-0 ml-3" type=button data-toggle=collapse data-target=#ato-docs-nav aria-controls=ato-docs-nav aria-expanded=false aria-label="Toggle docs navigation"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/></svg></button></form><nav class="ato-links collapse" id=ato-docs-nav><div class=ato-toc-item><a class=ato-toc-link href=../../../docs/overview/>What is zenoh?</a></div><div class=ato-toc-item><a class=ato-toc-link href=../../../docs/getting-started/quick-test/>Getting started</a><ul class="nav ato-sidenav"><li><a href=../../../docs/getting-started/quick-test/>For a Quick Test using Docker</a></li><li><a href=../../../docs/getting-started/installation/>Installation</a></li><li><a href=../../../docs/getting-started/key-concepts/>Key concepts</a></li><li><a href=../../../docs/getting-started/first-app/>Your First zenoh app</a></li></ul></div><div class="ato-toc-item active"><a class=ato-toc-link href=../../../docs/manual/abstractions/>Reference manual</a><ul class="nav ato-sidenav"><li><a href=../../../docs/manual/abstractions/>Abstractions</a></li><li><a href=../../../docs/manual/plugins/>Zenoh plugins</a></li><li><a href=../../../docs/manual/plugin-http/>REST plugin</a></li><li><a href=../../../docs/manual/plugin-storages/>Storages plugin</a></li><li><a href=../../../docs/manual/tls/ class=active>TLS authentication</a></li><li><a href=../../../docs/manual/user-password/>User-Password authentication</a></li><li><a href=../../../docs/manual/backends/>Zenoh backends and storages</a></li><li><a href=../../../docs/manual/backends-list/>List of backends</a></li></ul></div><div class=ato-toc-item><a class=ato-toc-link href=../../../docs/apis/apis/>API documentations</a></div></nav></div><div class="d-none d-xl-block col-xl-2 ato-toc"><div class=section-nav><nav id=TableOfContents><ul><li><a href=#tls-certificates-creation>TLS certificates creation</a></li><li><a href=#client-configuration>Client configuration</a></li><li><a href=#router-configuration>Router configuration</a></li><li><a href=#peer-configuration>Peer configuration</a></li><li><a href=#testing-the-tls-transport>Testing the TLS transport</a></li></ul></nav></div></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 ato-content ato-docs"><h1 class=ato-title>TLS authentication</h1><div class=github-edit><a class="fa fa-github" href=https://github.com/atolab/zenoh-web/tree/master/content/docs/manual/tls.md>Edit on GitHub</a></div><p>Zenoh supports TLS as a transport protocol.
As of today, the only supported TLS authentication mode is server-authentication: clients validate the server TLS certificate but not the other way around.
That is, the same way of operating in the web where the web browsers validate the identity of the server via means of the TLS certificate.</p><hr><h2 id=tls-certificates-creation>TLS certificates creation</h2><p>In order to use TLS as a transport protocol, we need first to create the TLS certificates.
While multiple ways of creating TLS certificates exist, in this guide we are going to use <a href=https://github.com/jsha/minica>minica</a> for simplicity:</p><blockquote><p><em>Minica is a simple CA intended for use in situations where the CA operator also operates each host where a certificate will be used. It automatically generates both a key and a certificate when asked to produce a certificate. It does not offer OCSP or CRL services. Minica is appropriate, for instance, for generating certificates for RPC systems or microservices.</em></p></blockquote><p>First of all, you need to install minica by following these <a href=https://github.com/jsha/minica#installation>instructions</a>.
Once you have succesfully installed on your machine, let&rsquo;s create the certificates as follows assuming that we will test zenoh over TLS on <em>localhost</em>.
First let&rsquo;s create a folder to store our certificates:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$/home/user: mkdir tls
$/home/user: <span style=color:#366>cd</span> tls
$/home/user/tls: <span style=color:#366>pwd</span>
/home/user/tls
</code></pre></div><p>Then, let&rsquo;s generate the TLS certificate for the <em>localhost</em> domain:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$/home/user/tls: minica --domains localhost
</code></pre></div><p>This should create the following files:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$/home/user/tls: ls
localhost   minica-key.pem  minica.pem
</code></pre></div><p><em>minica.pem</em> is the root CA certificate that will be used by the client to validate the server certificate.
The server certificate <em>cert.pem</em> and private key <em>key.pem</em> can be found inside the <em>localhost</em> folder.</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$/home/user/tls: ls localhost
cert.pem    key.pem
</code></pre></div><p>Once the above certificates have been correctly generated, we can proceed to configure zenoh to use TLS.</p><hr><h2 id=client-configuration>Client configuration</h2><p>The required <a href=https://docs.rs/zenoh/0.5.0-beta.5/zenoh/net/config/index.html>zenoh properties</a> for authenticating a <em>TLS server</em> for a client is <strong>tls_root_ca_certificate</strong>.
A configuration file for a <em>client</em> would be:</p><pre><code>tls_root_ca_certificate=/home/user/tls/minica.pem
</code></pre><p>When using such configuration, the client will use the provided <strong>tls_root_ca_certificate</strong> to authenticate the <em>TLS server certificate</em>.</p><p>Let&rsquo;s assume the above configuration is then saved with the name <em>client.conf</em>.</p><h2 id=router-configuration>Router configuration</h2><p>The required <a href=https://docs.rs/zenoh/0.5.0-beta.5/zenoh/net/config/index.html>zenoh properties</a> for configuring a <em>TLS certificate</em> for a router are <strong>tls_server_private_key</strong> and <strong>tls_server_certificate</strong>.</p><p>A configuration file for a <em>router</em> would be:</p><pre><code>tls_server_private_key=/home/user/tls/localhost/key.pem
tls_server_certificate=/home/user/tls/localhost/cert.pem
</code></pre><p>When using such configuration, the router will use the provided <strong>tls_server_private_key</strong> and <strong>tls_server_certificate</strong> for establishing a TLS session with any client.</p><p>Let&rsquo;s assume that the above configurations are then saved with the name <em>server.conf</em>.</p><h2 id=peer-configuration>Peer configuration</h2><p>The required <a href=https://docs.rs/zenoh/0.5.0-beta.5/zenoh/net/config/index.html>zenoh properties</a> for configuring a <em>TLS certificate</em> for a router are <strong>tls_root_ca_certificate</strong>, <strong>tls_server_private_key</strong> and <strong>tls_server_certificate</strong>.</p><p>A configuration file for a <em>peer</em> would be:</p><pre><code>tls_root_ca_certificate=/home/user/tls/minica.pem
tls_server_private_key=/home/user/tls/localhost/key.pem
tls_server_certificate=/home/user/tls/localhost/cert.pem
</code></pre><p>When using such configuration, the peer will use the provided <strong>tls_root_ca_certificate</strong> to authenticate the <em>TLS certificate</em> of the <em>peer</em> he is connecting to.
At the same time, the peer will use the provided <strong>tls_server_private_key</strong> and <strong>tls_server_certificate</strong> for initiating ingoming TLS sessions from other peers.</p><p>Let&rsquo;s assume that the above configurations are then saved with the name <em>peer.conf</em>.</p><hr><h2 id=testing-the-tls-transport>Testing the TLS transport</h2><p>Let&rsquo;s assume a scenario with one zenoh router and two clients connected to it: one publisher and one subscriber.</p><p>The first thing to do is to run the router passing its configuration, i.e. <em>router.conf</em>:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ zenohd -c router.conf -l tls/localhost:7447
</code></pre></div><p>Then, let&rsquo;s start the subscriber in client mode passing its configuration, i.e. <em>client.conf</em>:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ zn_sub --mode<span style=color:#555>=</span><span style=color:#c30>&#39;client&#39;</span> -c client.conf -e tls/localhost:7447
</code></pre></div><p>Lastly, let&rsquo;s start the publisher in client mode passing its configuration, i.e. <em>client.conf</em>:</p><div class=highlight><pre style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ zn_pub --mode<span style=color:#555>=</span><span style=color:#c30>&#39;client&#39;</span> -c client.conf -e tls/localhost:7447
</code></pre></div><p>As it can be noticed, the same <em>client.conf</em> is used for <em>zn_sub</em> and <em>zn_pub</em>.</p><div class=ato-next><b>Next up</b>: <a href=/docs/manual/user-password/>User-Password authentication</a></div></main></div></div><footer class="ato-footer text-muted"><div class="container-fluid p-6 p-md-5"><div class=row><div class=col-md-2><h5>Eclipse Incubation</h5><p><img src=../../../img/eclipse-incubation.png style=width:100px></p><p>Eclipse zenoh &trade; is an incubating project under the Eclipse Foundation.</p></div><div class=col-md-2><h5>More Information</h5><p><a href=https://www.eclipse.org/legal target=_blank>Legal</a></p><p><a href=https://www.eclipse.org/legal/privacy.php target=_blank>Privacy policy</a></p><p><a href=https://www.eclipse.org/legal/termsofuse.php target=_blank>Terms of use</a></p><p><a href=https://www.eclipse.org/legal/copyright.php target=_blank>Copyright</a></p><p><a href=https://www.eclipse.org/security/ target=_blank>Report a security issue</a></p><p><a href=https://www.eclipse.org/legal/epl-2.0/ target=_blank>Eclipse Public License 2.0</a></p><p><a href=https://www.apache.org/licenses/LICENSE-2.0 target=_blank>Apache License 2.0</a></p><p><a href=https://www.eclipse.org/ target=_blank>Eclipse Foundation</a></p></div><div class=col-md-2><h5>Sponsored by:</h5><p><a href=https://www.eclipse.org target=_blank><img src=../../../img/eclipse-foundation.svg style=width:100px></a></p><p><a href=https://www.adlinktech.com target=_blank><img src=../../../img/ADLINK-Logo.png style=width:100px></a></p><p><a href=https://www.futurewei.com target=_blank><img src=../../../img/futurewei-logo.png style=width:100px></a></p></div><div class=col-md-2><h5>Follow us</h5><p><a href=https://github.com/eclipse-zenoh/zenoh><i class="fa fa-github" aria-hidden=true></i>GitHub</a></p><p><a href=https://gitter.im/atolab/zenoh><i class="fa fa fa-comments-o" aria-hidden=true></i>Gitter</a></p><p><a href=../../../docs/overview/><i class="fa fa-info-circle" aria-hidden=true></i>About</a></p></div><div class=col-md-2><p><img src=../../../img/zenoh-dragon.png style=width:45px></p><p>Eclipse zenoh &trade; is free, open source and always will be.</p><p>Copyright &copy 2021 Eclipse Foundation</p><p>Build with <a href=https://gohugo.io/ target=_blank>HUGO</a></p><p>Theme inspired from: <a href=https://tokio.rs/ target=_blank>Tokio website theme</a></p></div></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js integrity=sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7 crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js integrity=sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8 crossorigin=anonymous></script><script src=../../../js/bootstrap.min.js></script><script src=../../../js/highlight.js></script><script>$(function(){$("pre code").each(function(i,block){if(block.className.indexOf('language-rust')>=0){var new_content='';var lines=block.textContent.split('\n');for(var i=0;i<lines.length;i++){if(lines[i].indexOf('# ')==0||lines[i]=='#'){continue}
new_content+=lines[i].trimRight()+'\n';}
block.textContent=new_content.replace(/\n\n\n/g,"\n\n").trimRight();}
hljs.highlightBlock(block);});});</script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js></script><script type=text/javascript>docsearch({apiKey:'d7b5b785798fe748621bcaa8301a2201',indexName:'zenoh',inputSelector:'#search-input',debug:false});</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-41082619-2','auto');ga('send','pageview');}</script></body></html>