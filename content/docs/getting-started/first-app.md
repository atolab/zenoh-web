---
title: "Your first Zenoh app"
weight : 2100
menu:
  docs:
    parent: getting_started
---

Let us take a step-by-step approach in putting together your first Zenoh application in Python.
As the first step, let us see how we get some data from a temperature sensor in our kitchen.
Then we see how we can route this data to store and perform some analytics.

Before cranking some code, let's define some terminology. 

<b>Zenoh</b> deals with <i>keys/values</i> where each key is a <i>path</i> and is associated to a <i>value</i>. A key looks like just a Unix file system path, such as ```myhome/kitchen/temp```. The value can be defined with different
encodings (string, JSON, raw bytes buffer...). 
<!-- To query the values stored by Zenoh, we use <i>selectors</i>. As the name suggest, a <i>selector</i> can use wildcards, such as <b>*</b> and <b>**</b> to represent a set of paths, such as, ```myhome/*/temp```. -->

Let's get started!

## Pub/sub in Zenoh

First thing first, we need to install the [zenoh Python library](https://github.com/eclipse-zenoh/zenoh-python).
```bash
pip install eclipse-zenoh==1.0.0rc1
```
*The examples are updated to use the 1.0 version currently in rc, which is why version must be specified in the installation command. You can find more information about the 1.0 changes in the [migration guides](https://zenoh.io/docs/migration_1.0/concepts/).*

Then, let's write an application, `z_sensor.py` that will produce temperature measurements at each second:

```python
import zenoh, random, time

random.seed()

def read_temp():
    return random.randint(15, 30)

if __name__ == "__main__":
    session = zenoh.open(zenoh.Config())
    key = 'myhome/kitchen/temp'
    pub = session.declare_publisher(key)
    while True:
        t = read_temp()
        buf = f"{t}"
        print(f"Putting Data ('{key}': '{buf}')...")
        pub.put(buf)
        time.sleep(1)
```

Now we need a subscriber, `z_subscriber.py` that can receive the measurements:

```python
import zenoh, time

def listener(sample):
    print(f"Received {sample.kind} ('{sample.key_expr}': '{sample.payload.deserialize(str)}')")
    
if __name__ == "__main__":
    session = zenoh.open(zenoh.Config())
    sub = session.declare_subscriber('myhome/kitchen/temp', listener)
    time.sleep(60)
```

Start the subscriber:
```bash
python3 z_subscriber.py
```
The subscriber waits for an update on `myhome/kitchen/temp`.
 
Now start `z_sensor.py` as follows
```bash
python3 z_sensor.py
```

You can see the values produced by the sensor being consumed by the subscriber.

## Store and Query in Zenoh

As the next step, let's see how the value generated by a publisher can be stored in Zenoh.
For this, we use [Zenoh router](../installation) (`zenohd`). 
By default, a Zenoh router starts without any storage. In order to store the temperature, we need to configure one.
Create a `zenoh-myhome.json5` configuration file for Zenoh with this content:
```json5
{
  plugins: {
    rest: {                        // activate and configure the REST plugin
      http_port: 8000              // with HTTP server listening on port 8000
    },
    storage_manager: {             // activate and configure the storage_manager plugin
      storages: {
        myhome: {                  // configure a "myhome" storage
          key_expr: "myhome/**",   // which subscribes and replies to query on myhome/**
          volume: {                // and using the "memory" volume (always present by default)
            id: "memory"
          }
        }
      }
    }
  }
}
```

[Install](../installation) and start the Zenoh router with this configuration file:

```bash
zenohd -c zenoh-myhome.json5
```

Now the data generated by our temperature sensor is stored in memory. 
We can retrieve the latest temperature value stored in Zenoh:

```python
import zenoh

if __name__ == "__main__":
    session = zenoh.open()
    replies = session.get('myhome/kitchen/temp')
    for reply in replies:
        try:
            print("Received ('{}': '{}')"
                .format(reply.ok.key_expr, reply.ok.payload.deserialize(str)))
        except:
            print("Received (ERROR: '{}')"
                .format(reply.err.payload.decode(str)))

session.close()
```
## Other examples

You can also have a look at the examples provided with each client API:

 - **Rust**: https://github.com/eclipse-zenoh/zenoh/tree/main/examples
 - **Python**: https://github.com/eclipse-zenoh/zenoh-python/tree/main/examples
 - **C**: https://github.com/eclipse-zenoh/zenoh-c/tree/main/examples
